(function(){function j(a){console.dir(a)}function h(a){console.log("--------------- "+a+" ---------------")}function r(a,b,c,d,g){a>b&&(a=b);this.min=a;this.max=b;this.step=c;this.initializer=d;this.callback=g||function(){}}function o(a){this.array=a}function q(a,b,c){this.enumclass=new o(a);this.array=this.enumclass.array;this.initializer=b;this.callback=c||function(){}}function n(a,b,c){this.enumclass=new o(a);this.array=this.enumclass.array;this.initializer=b;this.callback=c||function(){};var d=
this;this.enumlinear=new q(a,b,function(a){return function(b){d.index=d.enumlinear.index;d.value=b;d.history=d.history.concat(d.value);d.array=d.enumlinear.array;a(b)}}(c||function(){}));for(var g in this.enumlinear)this.enumlinear.hasOwnProperty(g)&&(this[g]=this.enumlinear[g])}function k(a,b,c){this.initializer=b;this.callback=c||function(){};var d=this;this.enumlinear=new q(a,b,function(a){return function(b){h("this.enumlinear callback");j("value: "+b);d.index=d.enumlinear.index;d.value=b;d.history=
d.history.concat(d.value);d.array=d.enumlinear.array;d.enumclass=d.enumlinear.enumclass;j(d);a(d.value)}}(c||function(){}));this.repeat=new n(["false","true","one"],"false",function(a){console.log("repeat:"+a)});this.shuffle=new n(["false","true"],"false",function(a){console.log("shuffle:::"+a);j(d.repeat.value);if(!d.orderedarray)d.orderedarray=d.enumlinear.enumclass.array||d.array||d.enumlinear.array||[];j("arr:::");j(d.orderedarray);switch(a){case "true":a=(void 0===d.value?[]:[d.value]).concat(d.orderedarray.shuffle().drop(d.value));
d.changeArray(a);break;default:d.changeArray(d.orderedarray),delete d.orderedarray}});this.repeat.init();this.shuffle.init();this.enumlinear.init();for(var g in this.enumlinear)this.enumlinear.hasOwnProperty(g)&&(this[g]=this.enumlinear[g])}function t(a){this.result=a;this.i=0}function w(a,b){this.file=a;this.type=a.type;this.name=a.name;this.filetype=a.filetype;if("video"===a.filetype&&b)this.htmlElement=b}function u(a,b){var c;this.app=a;if(b)for(c in b)if(b.hasOwnProperty(c)&&b[c]){var d=this.parse(c);
this.set(d,b[c]);this.keys.push(d)}this.keys=this.keys.sort()}function v(){var a=this;a.ui=l;a.key=new u(a,x);a.repeat=new n(["false","true","one"],function(){return m.get("repeat")||"false"},function(b){m.set("repeat",b);a.ui.setrepeat(b);"one"===b?a.order.repeatOne():"true"===b?a.order.repeatOn():a.order.repeatOff()});a.shuffle=new n(["false","true"],function(){return m.get("shuffle")||"false"},function(b){m.set("shuffle",b);a.ui.setshuffle(b);"true"===b?a.order.shuffleOn():a.order.shuffleOff()});
a.volume=new r(0,256,16,function(){var a=parseInt(m.get("volume"),10);return void 0!==a?a:128},function(b){m.set("volume",b);a.ui.setvolume(b);a.playing&&a.playing.setvolume(b/256)})}Array.prototype.clone=function(){return Array.apply(null,this)};Array.prototype.drop=function(a){for(var b=[],c=0;c<this.length;c++)this[c]!==a&&(b=b.concat([this[c]]));j(b);return b};console.log([1,2,3,4,5].drop(4));Array.prototype.shuffle=function(){for(var a=this.clone(),b=a.length,c,d,g=Math.random,f=Math.floor;b;)c=
f(g()*b),d=a[--b],a[b]=a[c],a[c]=d;return a};Array.prototype.unique=function(){var a=[],b,c,d,g,f;for(b=-1,d=this.length;b<d;++b){for(c=-1,g=a.length,f=!0;c<g;++c)a[c]===this[b]&&(c=g+1,f=!1);f&&a.push(this[b])}return a};if("undefined"!==typeof $)$.fn.texttitle=function(a){return this.text(a).attr("title",a)};if("undefined"!==typeof exports)exports.log=j,exports.logfn=h;r.prototype={value:void 0,at:function(a){this.value=void 0===a||isNaN(a)?void 0===this.value?(this.min+this.max)/2:this.assert(this.value):
this.assert(a);this.callback(this.value);return this.value},assert:function(a){return Math.min(Math.max(a,this.min),this.max)},increase:function(a){if(void 0===a||isNaN(a))a=this.step;return this.at(this.value+a)},decrease:function(a){if(void 0===a||isNaN(a))a=this.step;return this.increase(-a)},init:function(a){void 0!==a?this.at(a):"function"===typeof this.initializer?this.at(this.initializer()):this.at(this.initializer)},setToMin:function(){return this.at(this.min)},setToMax:function(){return this.at(this.max)}};
if("undefined"!==typeof exports)exports.Limited=r;o.prototype={array:[],succ:function(a){return this.toEnum(1+this.fromEnum(a))},pred:function(a){return this.toEnum(-1+this.fromEnum(a))},toEnum:function(a){if(this.array&&0<=a&&a<this.array.length)return this.array[a]},fromEnum:function(a){if(this.array)for(var b=0,c=this.array.length;b<c;b++)if(this.array[b]===a)return b},enumFrom:function(a){return!this.array?void 0:this.enumFromTo(a,this.array[this.array.length-1])},enumFromThen:function(a,b){if(this.array){for(var c=
this.fromEnum(a),d=this.fromEnum(b),g=[],f=c;0<=f&&f<this.array.length;f+=d-c)g=g.concat(this.array[f]);return g}},enumFromTo:function(a,b){return this.enumFromThenTo(a,this.succ(a),b)},enumFromThenTo:function(a,b,c){if(this.array){var a=this.fromEnum(a),b=this.fromEnum(b),c=this.fromEnum(c),b=b-a,d=[];if(0===b)d=d.concat(this.array[a]);else if(0<b)for(;a<=c&&a<this.array.length;a+=b)d=d.concat(this.array[a]);else for(;a>=c&&0<=a;a+=b)d=d.concat(this.array[a]);return d}}};if("undefined"!==typeof exports)exports.Enum=
o;if("undefined"===typeof window)o=require("./enum").Enum;q.prototype={index:0,value:void 0,history:[],head:function(){h("Enumlinear.prototype.head");return this.at(0)},last:function(){h("Enumlinear.prototype.last");return this.at(this.enumclass.array.length-1)},nonvalidIndex:function(a){return void 0===a||isNaN(a)||"number"!==typeof a},at:function(a){h("Enumlinear.prototype.at");if(this.nonvalidIndex(a))a=this.index;var b=this.enumclass.toEnum(a);if(void 0!==b)return this.value=b,this.index=a,this.array=
this.enumclass.array,this.history=this.history.concat(this.value),this.callback(this.value),this.value},atfromEnum:function(a){h("Enumlinear.prototype.atfromEnum");console.log("atfromEnum value: "+a);a=this.enumclass.fromEnum(a);return void 0===a?void 0:this.at(a)},next:function(a){h("Enumlinear.prototype.next");this.nonvalidIndex(a)&&(a=1);return this.at(this.index+a)},prev:function(a){h("Enumlinear.prototype.prev");this.nonvalidIndex(a)&&(a=-1);return this.next(a)},init:function(a){h("Enumlinear.prototype.init");
if(void 0===a)if("function"===typeof this.initializer)try{a=this.initializer()}catch(b){a=this.array[0]}else a=this.initializer;a=this.atfromEnum(a);if(void 0===a)return this.at(0)},concat:function(a){h("Enumlinear.prototype.concat");return this.changeArray(this.enumclass.array.concat(a))},splice:function(a,b){h("Enumlinear.prototype.splice");var c=this.enumclass.array;c.splice(a,b);return this.changeArray(c)},remove:function(a){h("Enumlinear.prototype.remove");console.log("removing : "+a);return this.splice(this.enumclass.fromEnum(a),
1)},changeArray:function(a){h("Enumlinear.prototype.changeArray");console.log(a);this.enumclass=new o(a);this.array=this.enumclass.array;this.at(this.enumclass.fromEnum(this.value)||0);return this}};if("undefined"!==typeof exports)exports.Enumlinear=q;if("undefined"===typeof window)o=require("./enum").Enum,q=require("./enumlinear").Enumlinear;n.prototype=new q;n.prototype.at=function(a){if(this.nonvalidIndex(a))a=this.index;var b=this.array.length;return this.enumlinear.at((a%b+b)%b)};n.prototype.changeArray=
function(a){this.enumlinear.changeArray(a);this.array=this.enumlinear.array;this.enumclass=this.enumlinear.enumclass};if("undefined"!==typeof exports)exports.Enumcycle=n;if("undefined"===typeof window)p=require("./prelude"),o=require("./enum").Enum,q=require("./enumlinear").Enumlinear,n=require("./enumcycle").Enumcycle;k.prototype=new q;k.prototype.at=function(a){h("Enumdinamic.prototype.at");if(this.nonvalidIndex(a))a=this.index;j("this:::");return this.enumlinear.at(a)};k.prototype.next=function(a){h("Enumdinamic.prototype.next");
if(void 0===a||isNaN(a))a=1;a=void 0===this.index?0:this.index+a;switch(this.repeat.value){case "one":a=this.index;break;case "true":var b=this.enumclass.toEnum(a);if(void 0===b)switch(this.shuffle.value){case "true":this.shuffleOn(),a++;default:b=this.array.length,a=(a%b+b)%b}break;default:if(b=this.enumclass.toEnum(a),void 0===b)switch(this.shuffle.value){case "true":this.shuffleOn();default:return}}this.at(a);return this.value};k.prototype.concat=function(a){h("Enumdinamic.prototype.concat");var b=
this.array||[];this.orderedarray=(this.orderedarray||this.array||[]).concat(a);this.changeArray(b.concat(a));"true"===this.shuffle.value&&this.shuffleOn()};k.prototype.remove=function(a){h("Enumdinamic.prototype.remove");if(this.orderedarray)this.orderedarray=this.orderedarray.drop(a);this.enumlinear.remove(a)};k.prototype.changeArray=function(a){h("Enumdinamic.prototype.changeArray");j(this.value);this.enumlinear.changeArray(a);this.array=this.enumlinear.array;j("this.array: "+this.array.join(","));
j("this.value: "+this.value);this.enumclass=this.enumlinear.enumclass;this.atfromEnum(this.value);for(var b in this.enumlinear)this.enumlinear.hasOwnProperty(b)&&(this[b]=this.enumlinear[b]);return this};k.prototype.setRepeat=function(a){this.repeat.atfromEnum(a)};k.prototype.repeatOff=function(){this.setRepeat("false")};k.prototype.repeatOn=function(){this.setRepeat("true")};k.prototype.repeatOne=function(){this.setRepeat("one")};k.prototype.repeatToggle=function(){this.repeat.next()};k.prototype.repeatToggleOnOff=
function(){this.setRepeat("false"===this.repeat.value?"true":"false")};k.prototype.setShuffle=function(a){this.shuffle.atfromEnum(a)};k.prototype.shuffleOff=function(){this.setShuffle("false")};k.prototype.shuffleOn=function(){this.setShuffle("true")};k.prototype.shuffleToggle=function(){this.shuffle.next()};k.prototype.shuffleToggleOnOff=function(){this.setShuffle("false"===this.shuffle.value?"true":"false")};if("undefined"!==typeof exports)exports.Enumdinamic=k;String.prototype.toBin=function(){for(var a=
[],b=9,c=this;--b;)a.push(c&128),c<<=1;return a.join("")};String.prototype.unsynchsafe=function(){return(this.charCodeAt(0)&127)<<21|(this.charCodeAt(1)&127)<<14|(this.charCodeAt(2)&127)<<7|this.charCodeAt(3)&127};t.prototype={read:function(){this.header();this.extendedheader();this.frames();return this.tags},header:function(){this.header=this.result.slice(this.i,this.i+=10);this.headerid=this.header.slice(0,3);this.version=[this.header.charCodeAt(3),this.header.charCodeAt(4)];this.flags=this.header.slice(5,
6).toBin();this.tagsize=this.header.slice(6,10).unsynchsafe()},extendedheader:function(){"1"===this.flags[1]&&this.result.slice(this.i,this.i+=this.result.slice(this.i,this.i+=4).unsynchsafe())},frames:function(){for(var a={},b=this.i,c=parseInt;b<this.tagsize;){var d=this.result.slice(b,b+=4),g;g=this.result.slice(b,b+=4);g=c(g.charCodeAt(3),10);this.result.slice(b,b+=2).toBin();var f;a:{f=this.result.slice(b,b+=g);switch(f.charCodeAt(0)){case 0:for(var e="",i=-1;i<f.length;)e+=String.fromCharCode(f.charCodeAt(i++)|
f.charCodeAt(i++))<<8;f=f.toString();break a;case 2:case 1:for(var e="",h=String.fromCharCode,j=void 0,i=1,k=f.length;i<k;)1===j||255===(f.charCodeAt(i)&255)?(j||(i+=2,j=1),e+=h(f.charCodeAt(i++)|f.charCodeAt(i++)<<8)):2===j||254===(f.charCodeAt(i)&254)?(j||(i+=2,j=2),e+=h(f.charCodeAt(i++)<<8|f.charCodeAt(i++))):e+=f[i++];f=e;break a;case 3:e="";h=String.fromCharCode;i=1;for(k=f.length;i<k;)j=f.charCodeAt(i),e=j&128?j&32?j&16?j&8?j&4?e+h((f.charCodeAt(i++)&1)<<30|(f.charCodeAt(i++)&63)<<24|(f.charCodeAt(i++)&
63)<<18|(f.charCodeAt(i++)&63)<<12|f.charCodeAt(i++)&6|f.charCodeAt(i++)):e+h((f.charCodeAt(i++)&3)<<24|(f.charCodeAt(i++)&63)<<18|(f.charCodeAt(i++)&63)<<12|f.charCodeAt(i++)&6|f.charCodeAt(i++)):e+h((f.charCodeAt(i++)&7)<<18|(f.charCodeAt(i++)&63)<<12|f.charCodeAt(i++)&6|f.charCodeAt(i++)):e+h((f.charCodeAt(i++)&15)<<12|(f.charCodeAt(i++)&63)<<6|f.charCodeAt(i++)&63):e+h((f.charCodeAt(i++)&31)<<6|f.charCodeAt(i++)&63):e+f[i++];f=e;break a}f=void 0}g&&f&&(a[d]=f,this.shortcuts[d]&&(a[this.shortcuts[d]]=
f))}this.tags=a},shortcuts:{TIT2:"title",TPE1:"artist",TALB:"album",TYER:"year",COMM:"comment",TRCK:"track",TCON:"genre",APIC:"picture",USLT:"lyrics"}};if("undefined"!==typeof exports)exports._ID3=t;w.prototype={toString:function(){return JSON.stringify({type:this.type,name:this.name,filetype:this.filetype,src:this.audio.src})},musicread:function(a,b,c){var d=this,g=window.URL&&window.URL.createObjectURL?function(a){return window.URL.createObjectURL(a)}:window.webkitURL&&window.webkitURL.createObjectURL?
function(a){return window.webkitURL.createObjectURL(a)}:void 0;if(g)if("audio"===d.file.filetype){d.audio=new Audio(g(d.file));if(!d.htmlElement)d.htmlElement.src=d.audio.src;d.audio.volume=a;d.audio.addEventListener("ended",function(){d.release();b()});c&&d.audio.play()}else{if("video"===d.file.filetype){g=d.htmlElement.src=g(d.file);if(!d.htmlElement)d.htmlElement.src=g;d.audio=d.htmlElement;d.audio.volume=a;d.audio.addEventListener("ended",function(){d.release();b()});c&&d.audio.play()}}else"audio"===
d.file.filetype?(g=new FileReader,g.onerror=function(a){j(a)},g.onload=function(g){d.audio=new Audio(g.target.result);if(!d.htmlElement)d.htmlElement.src=d.audio.src;d.audio.volume=a;d.audio.addEventListener("ended",function(){d.release();b()});c&&d.audio.play()},g.readAsDataURL(d.file)):b()},ontagload:function(a,b){this.tags=(new t(a.target.result)).read();this.tags.type=this.type;this.tags.name=this.name;b(this.tags)},mytagreader:function(a){var b=this,c=new FileReader;c.onload=function(c){b.ontagload(c,
a)};c.readAsBinaryString(this.file.webkitSlice(0,1E3))},tagread:function(a){webkitURL.createObjectURL(this.file);this.mytagreader(a)},play:function(a,b){var c=this;c.audio?(c.audio.volume=a,c.audio.addEventListener("ended",function(){c.release();b()}),c.audio.play()):c.musicread(a,b,!0)},pause:function(){this.audio&&this.audio.pause()},resume:function(){this.audio&&this.audio.play()},paused:function(){return!this.audio||this.audio.paused},setvolume:function(a){if(this.audio)this.audio.volume=a},mute:function(){this.predvol=
this.audio.volume;this.setvolume(0)},release:function(){this.audio&&delete this.audio},seekBy:function(a){if(this.audio){var b=this.audio.currentTime,c=this.audio.duration;if(0>a&&b<-a){if(this.audio.currentTime=0,b<-a/4)return!0}else this.audio.currentTime=b+a>c?c:this.audio.currentTime+a}}};var m={get:function(a){return localStorage.getItem(a)},set:function(a,b){localStorage.setItem(a,b)},remove:function(a){localStorage.removeItem(a)},clear:function(){localStorage.clear()}};if("undefined"!==typeof exports)exports.local=
m;var s={"classic-default":{"background-color":{"div#wrapper":"#aaa","div#info":"#eee","div#playlist":"#fff","thead tr":"#ddd","div#musicSlider":"#aaa","div#musicSlider a":"#666","div#musicSlider a:focus":"#333","div#volumeSlider":"#eee","tbody tr:nth-child(odd) ":"#fff","tbody tr:nth-child(even) ":"#ddf","tbody tr.nP":"#aaf","tbody tr.ui-selected":"#08f"},color:{"tbody tr.ui-selected":"#fff"}},"classic-pink":{"background-color":{"div#wrapper":"#f66","div#info":"#fbb","thead tr":"#f99","div#musicSlider":"#f66",
"div#musicSlider a":"#844","div#musicSlider a:focus":"#622","div#volumeSlider":"#f88","tbody tr:nth-child(odd) ":"#fdd","tbody tr:nth-child(even) ":"#fbb","tbody tr.nP":"#f77","div#playlist":"#fdd","tbody tr.ui-selected":"#f22"},color:{"tbody tr.ui-selected":"#fff"}},"classic-yellow":{"background-color":{"div#wrapper":"#ff0","div#info":"#ff8","thead tr":"#ff8","div#musicSlider":"#ff0","div#musicSlider a":"#880","div#musicSlider a:focus":"#640","div#volumeSlider":"#ff8","tbody tr:nth-child(odd) ":"#ff7",
"tbody tr:nth-child(even) ":"#ff6","tbody tr.nP":"#ff4","div#playlist":"#ffb","tbody tr.ui-selected":"#ff0"},color:{"tbody tr.ui-selected":"#000!important"}},"classic-orange":{"background-color":{"div#wrapper":"#f80","div#info":"#fb8","thead tr":"#fb8","div#musicSlider":"#f80","div#musicSlider a":"#840","div#musicSlider a:focus":"#620","div#volumeSlider":"#fb8","tbody tr:nth-child(odd) ":"#ff8","tbody tr:nth-child(even) ":"#fd6","tbody tr.nP":"#fa0","div#playlist":"#fdb","tbody tr.ui-selected":"#f60"},
color:{"tbody tr.ui-selected":"#000"}},"classic-lime":{"background-color":{"div#wrapper":"#6f6","div#info":"#bfb","div#playlist":"#fff","thead tr":"#9f9","div#musicSlider":"#6f6","div#musicSlider a":"#484","div#musicSlider a:focus":"#262","div#volumeSlider":"#8f8","tbody tr:nth-child(odd) ":"#dfd","tbody tr:nth-child(even) ":"#bfb","tbody tr.nP":"#7f7","div#playlist":"#dfd","tbody tr.ui-selected":"#2f2"},color:{"tbody tr.ui-selected":"#fff"}},"classic-lblue":{"background-color":{"div#wrapper":"#66f",
"div#info":"#bbf","thead tr":"#99f","div#musicSlider":"#66f","div#musicSlider a":"#448","div#musicSlider a:focus":"#226","div#volumeSlider":"#88f","tbody tr:nth-child(odd) ":"#ddf","tbody tr:nth-child(even) ":"#bbf","tbody tr.nP":"#77f","div#playlist":"#ddf","tbody tr.ui-selected":"#22f"},color:{"tbody tr.ui-selected":"#fff"}},"classic-purple":{"background-color":{"div#wrapper":"#f0f","div#info":"#f8f","thead tr":"#f8f","div#musicSlider":"#f0f","div#musicSlider a":"#808","div#musicSlider a:focus":"#604",
"div#volumeSlider":"#f8f","tbody tr:nth-child(odd) ":"#f7f","tbody tr:nth-child(even) ":"#f6f","tbody tr.nP":"#f4f","div#playlist":"#fbf","tbody tr.ui-selected":"#f0f"},color:{"tbody tr.ui-selected":"#000"}},"classic-dark":{"background-color":{"div#wrapper":"#000","div#info":"#333","thead tr":"#333","div#musicSlider":"#000","div#musicSlider a":"#666","div#musicSlider a:focus":"#999","div#volumeSlider":"#333","div#volumeSlider a":"#666","div#volumeSlider a:focus":"#666","tbody tr:nth-child(odd) ":"#222",
"tbody tr:nth-child(even) ":"#292929","tbody tr.nP":"#444","div#playlist":"#111","tbody tr.ui-selected":"#080808"},color:{"div#wrapper":"#fff"}}},l={start:function(a){var b=this;b.player=a;b.div=function(a,b){a.forEach(function(a){b[a]=$("#"+a)});return b}("about,conf,config,current,filename,fileselect,firstrow,globalcontrol,help,musicSlider,mute,next,open,pause,play,playlist,prev,property,remain,repeat,scheme,shuffle,tablebody,tablediv,tagread,volumeSlider,volumeon,wrapper,filter,filterword,matchnum".split(","),
{tbody:$("#tbody"),thead:$("thead"),table:$("table"),video:document.getElementsByTagName("video")[0]});b.initdrop();b.initbuttons();b.colorset();b.initsize();b.initslider();b.initschemes();b.initsplitter();b.resizableSet();b.selectableSet();b.initFilter();$(window).resize(function(){b.initsize()});$("div#appname a").text("Local Player v"+a.version)},initdrop:function(){var a=this;document.body.ondragover=function(a){a.preventDefault()};document.body.ondrop=function(b){b.stopPropagation();b.preventDefault();
b.dataTransfer&&b.dataTransfer.files&&a.player.readFiles(b.dataTransfer.files)}},initbuttons:function(){var a=this,b=a.player;a.div.open.click(function(){a.div.fileselect.click()});a.div.fileselect.change(function(a){b.readFiles(a.target.files)});a.div.play.click(function(){b.toggle()});a.div.pause.click(function(){b.toggle()});a.div.prev.click(function(){b.prev()});a.div.next.click(function(){b.next()});a.div.mute.click(function(){b.mute()});a.div.volumeon.click(function(){b.resume()});a.div.repeat.click(function(){b.repeat.next()});
a.div.shuffle.click(function(){b.shuffle.next()});a.div.conf.click(function(){a.div.config.fadeToggle(200)});$("img.lbutton, img.rbutton").mouseup(function(){$(this).css({top:"50%"})}).mousedown(function(){$(this).css({top:1.03*parseInt($(this).css("top"),10)+"%"})});a.div.filename.click(function(){$("tr.ui-selected").UNSELECT();$("tr.nP").SELECT().LASTSELECT();a.focusIndex=0;a.focusUpdate()});a.div.tablebody.click(function(){a.focusIndex=0;a.focusUpdate(!0)})},initsize:function(){var a=this.div.tbody.width(),
b=12*(window.innerWidth-1280)/2360+12;this.div.wrapper.css({"font-size":b});this.div.playlist.height(window.innerHeight-this.div.playlist.offset().top-b);this.div.tablediv.height(window.innerHeight-this.div.tablediv.offset().top-b);this.div.tablebody.height(window.innerHeight-this.div.tablebody.offset().top-b);$("tr").css({width:a});this.fullScreenOff||this.fullScreenOff()},initsplitter:function(){var a;void 0===m.get("splitter")?a={now:0.05,filename:0.1,artist:0.2,title:0.3,track:0.05,album:0.25}:
(a=JSON.parse(m.get("splitter")),a.now=0.05);for(var b in a)$("th."+b).width(a[b]*this.div.thead.width())},initschemes:function(){var a=m.get("scheme")||"classic-default",b=this,c;for(c in s)$("<a />").attr("scheme",c).css({color:s[c].color["div#wrapper"]||"black","background-color":s[c]["background-color"]["div#wrapper"]}).addClass(a===c?"currentScheme":"").click(function(){b.setscheme($(this).attr("scheme"))}).appendTo(this.div.scheme)},initslider:function(){var a=this;this.div.volumeSlider.slider({min:0,
max:256,step:8,value:a.player.volume.value,slide:function(){a.player.updatevolume()},stop:function(){a.player.updatevolume()}});this.div.musicSlider.slider({min:0,max:1,step:0.01,start:function(b,c){a.startSlide(b,c)},stop:function(b,c){a.stopSlide(b,c)}}).slider("disable")},startSlide:function(){this.seeking&&clearInterval(this.seeking)},stopSlide:function(a,b){var c=this;if(c.player.seekAt(b.value))c.seeking=setInterval(function(){c.seek()},1E3)},addfile:function(a,b){var c=[],d=-1,g=this.div.tbody.width();
c[++d]='<tr class="music" number="';c[++d]=b;c[++d]='" style="width:';c[++d]=g;c[++d]='px;">';c[++d]='<td class="now">';c[++d]="<td></td>";c[++d]='<td><div class="filename" title="';c[++d]=a.name;c[++d]='" >';c[++d]=a.name;c[++d]="</div></td>";c[++d]='<td></td><td><div class="artist"></div></td><td></td><td><div class="title"></div></td><td></td><td><div class="track"></div></td><td></td><td><div class="album"></div></td></tr>';this.div.tbody[0].innerHTML+=c.join("")},ontagread:function(a,b){$("tr[number="+
b+"]").find(".artist").texttitle(a.artist||"").end().find(".track").texttitle(a.track||"").end().find(".title").texttitle(a.title||"").end().find(".album").texttitle(a.album||"")},setdblclick:function(){var a=this;$("tr.music").dblclick(function(b){a.div.musicSlider.slider({value:0});b=parseInt($(b.target).closest("tr").attr("number")||b.closest("tr").attr("number")||b.attr("number"),10);a.player.pause();a.player.play(b)})},getvolume:function(){return parseInt(this.div.volumeSlider.slider("value"),
10)},setvolume:function(a){this.div&&this.div.volumeSlider&&this.div.volumeSlider.slider({value:a})},popupvideo:function(){this.div.video.parentNode.style.visibility="visible"},hidevideo:function(){this.div.video.parentNode.style.visibility="hidden"},showAlbumArt:function(a){var b=$("img#art")[0];a.picture?(a=a.picture,b.src="data:"+a.format+";base64,"+Base64.encodeBytes(a.data),b.style.display="block",j("displaying image")):(b.style.display="none",j("hiding image"))},play:function(a){var b=this;
b.div.musicSlider.slider("enable");var c=b.player.playing;b.showAlbumArt(c);b.showFileName(c.name,a);$("tr.nP").removeClass("nP").find("img").remove();$("tr[number="+a.toString()+"]").addClass("nP").find(".now").append('<img src="./img/now.png">');a=$("tr.ui-selected");2>a.size()&&(a.UNSELECT(!0),$("tr.nP").SELECT().LASTSELECT());b.seeking&&clearInterval(b.seeking);b.seeking=setInterval(function(){b.seek()},1E3);setTimeout(function(){b.reflesh()},50);setTimeout(function(){b.reflesh()},500)},pause:function(){var a=
this;this.seeking&&clearInterval(this.seeking);this.reflesh(!1);setTimeout(function(){a.reflesh()},50)},reflesh:function(a){this.div.play.attr(!1===a||void 0!==this.player.playing&&this.player.playing.paused()?{src:"./img/play.png",title:"Play"}:{src:"./img/pause.png",title:"Pause"})},seek:function(){var a=function(a){a=parseInt(a,10);if(isNaN(a))return"00:00";var c=parseInt(a/60%60,10),d=parseInt(a/3600,10),a=a%60;return 0<d?d.toString()+":"+(10>c?"0":"")+c.toString()+":"+(10>a?"0":"")+a.toString():
(10>c?"0":"")+c.toString()+":"+(10>a?"0":"")+a.toString()};return function(){if(void 0!=this.player.playing&&this.player.playing.audio){var b=this.player.playing.audio.currentTime,c=this.player.playing.audio.duration;this.div.musicSlider.slider({value:b/c});this.div.current.text(a(b));this.div.remain.text("-"+a(c-b))}}}(),colorset:function(){var a=m.get("scheme")||"classic-default",b=s[a];$("a.currentScheme").removeClass("currentScheme");$("a[scheme="+a+"]").addClass("currentScheme");var a=[],c;for(c in b)for(var d in b[c])a.push(d+
" { "+c+":"+b[c][d]+";}");$("style#sch").text(a.join("\n")).size()||$("<style />",{id:"sch"}).text(a.join("\n")).appendTo($("head"))},setscheme:function(a){m.set("scheme",a);this.colorset()},resizableSet:function(){var a=this;$("th:not(.splitter)+th:not(.splitter)",this.div.thead).each(function(b){var c=!1,d=$("<th />",{"class":"splitter"}).mousedown(function(){c=!0}).insertBefore($(this));0!==b&&$(window).mouseup(function(){c&&(c=!1,a.afterResize())}).mousemove(function(a){if(c){var b=d.prev().width()+
d.next().width();d.prev().width(a=-d.prev().offset().left+a.clientX);d.next().width(b-a)}})})},afterResize:function(){var a=[],b={},c=this.div.thead.width();$("th:not(.splitter)").each(function(d){var g=$(this).width()/(c-0);a.push("td:nth-child("+(d+1)+") {width:"+100*g+"%!important;}");b[$(this).attr("class")]=g});m.set("splitter",JSON.stringify(b));this.selectableSet()},selectableSet:function(){var a=this,b=a.div.tbody.width();$("tr",a.div.tbody).each(function(){var c=$(this),d=$("<tr />").attr({number:c.attr("number")}).append(c.children()).click(function(b){var c=
$("tr.last-select");a.focusIndex=0;a.focusUpdate(!0);if(b.shiftKey&&!b.altKey&&c.size()){if(b.ctrlKey){var d=$("tr.ui-selected");setTimeout(function(){d.SELECT(!0)},20)}b.clientY<c.position().top?setTimeout(function(){c.SELECT(!0).LASTSELECT().prevAll().filter(function(){return $(this).position().top>b.clientY}).SELECT(!0)},20):setTimeout(function(){c.SELECT(!0).LASTSELECT().nextAll().filter(function(){return $(this).position().top<b.clientY}).SELECT(!0)},20)}}).dblclick(function(b){b=parseInt($(b.target).closest("tr").attr("number")||
b.closest("tr").attr("number")||b.attr("number"),10);a.player.pause();a.player.play(b)}).width(b).addClass(c.hasClass("nP")?"nP":"").addClass(c.hasClass("moved")?"ui-selected moved":"").addClass(c.hasClass("ui-selected")?"ui-selected":"").appendTo(a.div.tbody);c.ISSELECTED()&&setTimeout(function(){d.SELECT(!0)},30)}).remove();$.fn.drag_drop_multi_select.unique=0;$.fn.drag_drop_multi_select.stack=[];$.fn.drag_drop_multi_select.settings=[];this.div.tbody.drag_drop_multi_select({element_to_drag_drop_select:"tr, this.div.tbody",
elements_to_drop:this.div.tbody,moveOpacity:0.7})},setrepeat:function(a){this.div&&this.div.repeat&&this.div.repeat.css({opacity:"false"===a?0.4:""}).attr({src:"one"===a?"./img/one.png":"./img/repeat.png"})},setshuffle:function(a){this.div&&this.div.shuffle&&this.div.shuffle.css({opacity:"true"===a.toString()?"":0.4})},showFileName:function(a,b){var c=this.player.musics[b].tags;if(c&&c.TIT2)document.title=(c.TIT2||"")+" - "+(c.TPE1||"")+","+(c.TALB||""),a=c.TPE1+" - "+c.TIT2;document.title=a;this.div.filename.texttitle(a)},
selectDown:function(){var a=$("tr.ui-selected"),b=$("tr.last-select");a.size()?a.UNSELECT(!0).next().andSelf().last().SELECT().LASTSELECT():b.size()?b.last().SELECT().LASTSELECT():$("tr.nP").next().andSelf().last().SELECT().LASTSELECT().size()||$("tr",this.div.tbody).first().SELECT().LASTSELECT()},extendDown:function(){var a=$("tr.last-select");a.size()&&(a.prev().ISSELECTED()?a.prevAll().filter(function(){var a=!0;return function(){return a&&(a=$(this).ISSELECTED())}}()).last().UNSELECT():a.nextAll().filter(function(){var a=
!0;return function(){return a&&(a=$(this).prev().ISSELECTED())}}()).last().SELECT())},selectUp:function(){var a=$("tr.ui-selected"),b=$("tr.last-select");a.size()?a.UNSELECT(!0).prev().andSelf().first().SELECT().LASTSELECT():b.size()?b.first().SELECT().LASTSELECT():$("tr.nP").prev().andSelf().first().SELECT().LASTSELECT().size()||$("tr",this.div.tbody).last().SELECT().LASTSELECT()},extendUp:function(){var a=$("tr.last-select");a.size()&&(a.next().ISSELECTED()?a.nextAll().filter(function(){var a=!0;
return function(){return a&&(a=$(this).ISSELECTED())}}()).last().UNSELECT():a.prevAll().filter(function(){var a=!0;return function(){return a&&(a=$(this).next().ISSELECTED())}}()).last().SELECT())},selectHome:function(){$("tr.ui-selected").UNSELECT(!0);this.div.tbody.children().first().SELECT().LASTSELECT()},extendToHome:function(){$("tr.ui-selected").removeClass("ui-selected ddms_selected");$("tr.last-select").SELECT(!0).prevAll().SELECT(!0).last().SELECT()},selectEnd:function(){$("tr.ui-selected").UNSELECT(!0);
this.div.tbody.children().last().SELECT().LASTSELECT()},extendToEnd:function(){$("tr.ui-selected").removeClass("ui-selected ddms_selected");$("tr.last-select").SELECT(!0).nextAll().SELECT(!0).last().SELECT()},selectAll:function(){this.div.tbody.children().SELECT(!0).last().LASTSELECT()},unselectAll:function(){this.div.tbody.children().UNSELECT(!0)},toggleHelp:function(){this.div.help.fadeToggle(200);$("div#help:hidden").size()&&div.tablebody.focus()},toggleAbout:function(){this.div.about.fadeToggle(200)},
toggleConfig:function(){this.div.config.fadeToggle(200)},deleteSelected:function(){var a=this.player;$("tr.ui-selected").last().next().LASTSELECT();$("tr.ui-selected").first().prev().LASTSELECT(!0);$("tr.ui-selected").map(function(b,c){return a.remove(parseInt($(c).attr("number"),10))});$("tr.ui-selected").remove()},pageDown:function(){this.div.tablebody.scrollTop(this.div.tablebody.scrollTop()+0.8*this.div.tablebody.height());$("tr.ui-selected").UNSELECT(!0);var a=window.innerHeight;$("tr",this.div.tbody).filter(function(){return $(this).position().top<
a}).last().SELECT().LASTSELECT()},extendPageDown:function(){var a=this;a.div.tablebody.scrollTop(a.div.tablebody.scrollTop()+0.8*a.div.tablebody.height());if($("tr.last-select").prev().ISSELECTED())$("tr.ui-selected").filter(function(){return $(this).position().top<a.div.thead.position().top+40}).UNSELECT(!0);else{var b=window.innerHeight;$("tr.last-select").nextAll().filter(function(){return $(this).position().top<b}).SELECT(!0).last().SELECT()}},pageUp:function(){this.div.tablebody.scrollTop(this.div.tablebody.scrollTop()-
0.8*this.div.tablebody.height());$("tr.ui-selected").UNSELECT(!0);$("tr",this.div.tbody).filter(function(){return 0<$(this).position().top}).first().SELECT().LASTSELECT()},extendPageUp:function(){this.div.tablebody.scrollTop(this.div.tablebody.scrollTop()-0.8*this.div.tablebody.height());var a=window.innerHeight,b=$("tr.last-select",this.div.tbody);b.next().ISSELECTED()?$("tr.ui-selected").filter(function(){return $(this).position().top>a-50}).UNSELECT(!0):b.prevAll().filter(function(){return 0<$(this).position().top}).SELECT(!0).last().SELECT()},
defaultEnter:function(){if(!$("textarea#shortcuts:focus").size())switch($("div#help:visible,div#config:visible,div#about:visible,div#property:visible").size()){case 0:$("tr.ui-selected").UNSELECT(!0).first().children().first().dblclick();break;default:this.div.config.add(this.div.help).add(this.div.property).add(this.div.about).filter(function(){return $(":visible",this).size()}).last().fadeOut(200)}},viewInformation:function(a){this.div.property.fadeIn(200);if(a.tags){var b={TALB:"album",TIT2:"title",
TPE1:"artist",TRCK:"track",TDRC:"year"},c=$("tr.ui-selected").map(function(b,c){return a.tags[parseInt($(c).attr("number"),10)]}),d;for(d in b)$("dd#id"+b[d]).text("\u3000"+c.map(function(a,b){return b[d]}).unique().join())}},escape:function(){this.player.key.unlockAll();this.filterEnd();switch($("#help:visible,#config:visible,#about:visible,#property:visible,#filter:visible").size()){case 0:$("div#musicSlider a:focus, div#volumeSlider a:focus").size()?$("div#musicSlider a, div#volumeSlider a").focusout():
$("tr.ui-selected").UNSELECT(!0);break;default:this.div.config.add(this.div.help).add(this.div.property).add(this.div.about).filter(function(){return $(":visible",this).size()}).last().fadeOut(200)}},click:function(a){var b=this.div[a]||$("img#"+a);b.mousedown().click();setTimeout(function(){b.mouseup()},200)},focusIndex:0,focusElements:function(){return[$("#tbody"),$("div#musicSlider a"),$("div#volumeSlider a")]},focusUpdate:function(a){this.focusElements()[this.focusIndex].focus();a||0===this.focusIndex&&
($("tr.ui-selected").first().SELECT().size()||$("tr.nP").SELECT().LASTSELECT())},focusToggle:function(){this.focusIndex=(this.focusIndex+1)%3;this.focusUpdate()},focusToggleReverse:function(){this.focusIndex=(this.focusIndex-1+this.focusElements().length)%3;this.focusUpdate()},fullScreen:!1,setVideoSize:function(a,b){this.div.video.style.width=a+"px";this.div.video.style.marginLeft=-a/2+"px";this.div.video.style.height=b+"px";this.div.video.style.marginTop=-b/2+"px"},fullScreenOn:function(){this.fullScreen=
!0;var a=this.div.video;a.controls=!1;a.style.cursor="none";j("fullScreenOn");document.onmousemove=function(){j(a);a.controls=!0;a.style.cursor="true";setTimeout(function(){a.controls=!1;a.style.cursor="none"},1E3)};a.webkitRequestFullScreen?a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):this.setVideoSize(window.outerWidth,window.outerHeight)},fullScreenOff:function(){j("fullScreenOff");this.fullScreen=!1;this.div.video.controls=!0;this.div.video.style.cursor="auto";var a;document.webkitCancelFullScreen?
document.webkitCancelFullScreen():this.setVideoSize(a=0.6*window.outerWidth,9*(a/16))},fullScreenToggle:function(){this.fullScreen?this.fullScreenOff():this.fullScreenOn()},initFilter:function(){var a=this;this.div.filterword.keydown(function(b){a.filterKeydown(b)})},filterStart:function(){var a=[];$("ui-selected");this.div.filter.fadeIn(200);var b=this.div.filterword.focus()[0];b.selectionStart=0;b.selectionEnd=b.value.length;$("tr",this.div.tbody).each(function(b,d){var g=b,f=self.player.musics[$(d).attr("number")].tags,
e=[];for(b in f)e.push(f[b]);a[g]=e.join("__").toLowerCase()});this.div.matchnum.text("");this.filterTags=a},filterKeydown:function(a){var b=this;setTimeout(function(){if(13===a.keyCode)b.filterBlink();else if(27===a.keyCode)b.filterEnd();else{var c=a.target.value.toLowerCase(),d=[],g=$("tr",b.div.tbody);$("tr.ui-selected",b.div.tbody).UNSELECT(!0);if(c)try{b.filterTags.forEach(function(a,b){null!==a.match(c)&&d.push(b)}),d.forEach(function(a){g.eq(a).SELECT(!0)}),b.div.matchnum.text(d.length+"/"+
g.length),$("tr.ui-selected")}catch(f){}else b.div.matchnum.text("0/"+g.length)}},20)},filterEnd:function(){this.div.filter.fadeOut(200);this.div.filterword.focusout();this.focusUpdate()},filterIndex:0,filterBlink:function(){j("filterBlink");if(isNaN(this.filterIndex))this.filterIndex=0;var a=$("tr.ui-selected"),b=a.eq(this.filterIndex).UNSELECT(!0);setTimeout(function(){b.SELECT(!1,!0)},200);this.filterIndex=++this.filterIndex%a.size()}};$.fn.SELECT=function(a,b){if(this.size()){this.addClass("ui-selected ddms_selected");
if(a)return this;var c=this.offset().top,d=l.div.tablebody.offset().top,g=c-30-d,c=c+60-l.div.tablediv.height()-d;0>g?b?l.div.tablebody.animate({scrollTop:"+="+g},{duration:"fast",easing:"linear"}):l.div.tablebody.scrollTop(l.div.tablebody.scrollTop()+g):0<c&&(b?l.div.tablebody.animate({scrollTop:"+="+c},{duration:"fast",easing:"linear"}):l.div.tablebody.scrollTop(l.div.tablebody.scrollTop()+c))}return this};$.fn.UNSELECT=function(a){a||this.SELECT();return this.removeClass("ui-selected ddms_selected last-select")};
$.fn.LASTSELECT=function(a){a||$("tr.last-select",l.div.tbody).removeClass("last-select");return this.addClass("last-select")};$.fn.ISSELECTED=function(){return this.hasClass("ui-selected")};$.fn.drag_drop_multi_select.defaults.after_drop_action=function(a,b,c,d){var b=a.first().attr("number"),g=$("tr",l.div.tbody).first().height()/2,f=d.clientY,d=$("tr",l.div.tbody).filter(function(){var a=f-$(this).offset().top;return-g<=a&&a<g}).first();b===d.attr("number")&&(d=a.last().next());a.insertBefore(d).addClass("ui-selected moved");
setTimeout(function(){l.selectableSet()},30);setTimeout(function(){$("tr.ui-selected",l.div.tbody).removeClass("ui-selected moved last-select")},1E3)};u.prototype={keys:[],callback:{},start:function(){var a=this;$(window).keypress(function(b){switch(b.target.localName){case "input":case "textarea":break;default:a.prevent(b)}});$(window).keydown(function(b){switch(b.target.localName){case "input":case "textarea":break;default:a.keydown(b),a.callback[a.convert(b)]&&a.prevent(b)}})},keydown:function(a){this.onlyMeta(a)||
this.keydownstr(this.convert(a),a)},keydownstr:function(a,b){var c=this;c.keyqueue.push(a);if(c.triggerTimer)clearTimeout(c.triggerTimer),c.triggerTimer=void 0;c.triggerInstantly()?c.trigger(b):c.triggerTimer=setTimeout(function(){c.trigger(b)},c.watingTime)},triggerInstantly:function(){var a=this.keyqueue.join(" "),b=this.keys.indexOf(a);return 0>b?!1:void 0!==this.keys[b+1]&&0>this.keys[b+1].indexOf(a)?!0:!1},onlyMeta:function(a){switch(this.codes[a.keyCode]){case "alt":case "ctrl":case "shift":return!0;
default:return!1}},trigger:function(a){var b=this.callback[this.keyqueue.join(" ")];j(this.keyqueue.join(" "));b&&(this.prevent(a),b(this.app,a));this.keyqueue=[]},keyqueue:[],triggerTimer:void 0,watingTime:480,prevent:function(a){a&&a.preventDefault&&a.preventDefault()},convert:function(a){var b=this.meta(a);return""!==b||this.codes[a.keyCode]&&1<this.codes[a.keyCode].length?"<"+b+this.keyCode(a.keyCode)+">":this.keyCode(a.keyCode)},meta:function(a){return(a.global?"g-":"")+(a.ctrlKey||a.metaKey||
this.lockconfig.ctrlKey?"c-":"")+(a.shiftKey||this.lockconfig.shiftKey?"s-":"")+(a.altKey||this.lockconfig.altKey?"a-":"")},parse:function(a){for(var a=a.toLowerCase().replace(/ /g,""),b=[],c=[];a;){if(!(c=a.match(/^<[^<>]*>/)))c=[a[0]];b=b.concat(c);a=a.slice(c[0].length)}return b.join(" ")},set:function(a,b){var c=this;"function"===typeof b?c.callback[a]=b:"string"===typeof b&&(c.callback[a]=function(){return function(){for(var a=c.parse(b).split(" "),g=0;g<a.length;g++)setTimeout(function(b){return function(){c.keydownstr(a[b])}}(g),
10*g)}}(c.callback))},lock:function(a){void 0!==this.lockconfig[a]&&(j("lock"+a),this.lockconfig[a]=!0);return this},lockAll:function(){for(var a in this.lockconfig)this.lockconfig.hasOwnProperty(a)&&(this.lockconfig[a]=!0)},unlock:function(a){void 0!==this.lockconfig[a]&&(this.lockconfig[a]=!1);return this},unlockAll:function(){for(var a in this.lockconfig)this.lockconfig.hasOwnProperty(a)&&(this.lockconfig[a]=!1)},togglelock:function(a){void 0!==this.lockconfig[a]&&(this.lockconfig[a]=!this.lockconfig[a]);
return this},lockconfig:{shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1},codes:{8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",32:"space",33:"pgup",34:"pgdn",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",91:"ctrl",106:"*",107:"+",111:"/",144:"numlock",186:":",187:";",188:",",189:"-",190:".",191:"/",192:"@",219:"[",220:"\\",221:"]",222:"^",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},
keyCode:function(a){if(this.codes[a])return this.codes[a];if(48<=a&&57>=a)return a-48;if(65<=a&&90>=a)return String.fromCharCode(a).toLowerCase();if(96<=a&&105>=a)return a-96;console.log("unknown key: "+a)}};if("undefined"!==typeof exports)exports.Key=u;var e={PlayPause:function(){return function(a){a.ui.click("play")}},OpenFile:function(){return function(a){a.ui.click("open")}},NextMusic:function(){return function(a){a.next()}},PreviousMusic:function(){return function(a){a.prev()}},SeekForward:function(a){return function(b){b.seekBy(a[0])}},
SeekBackward:function(a){return function(b){b.seekBy(-a[0])}},SeekPercent:function(a){return function(b){b.seekAt(a[0])}},ToggleRepeat:function(){return function(a){a.ui.click("repeat")}},ToggleShuffle:function(){return function(a){a.ui.click("shuffle")}},VolumeUp:function(){return function(a){a.volumeup()}},VolumeDown:function(){return function(a){a.volumedown()}},VolumeMute:function(){return function(a){a.ui.click("mute")}},VolumeResume:function(){return function(a){a.ui.click("volumeon")}},VolumeToggleMute:function(){return function(a){a.ui.click(a.ismute()?
"volumeon":"mute")}},SelectDown:function(){return function(a){a.ui.selectDown()}},ExtendDown:function(){return function(a){a.ui.extendDown()}},SelectUp:function(){return function(a){a.ui.selectUp()}},ExtendUp:function(){return function(a){a.ui.extendUp()}},SelectHome:function(){return function(a){a.ui.selectHome()}},ExtendToHome:function(){return function(a){a.ui.extendToHome()}},SelectEnd:function(){return function(a){a.ui.selectEnd()}},ExtendToEnd:function(){return function(a){a.ui.extendToEnd()}},
SelectAll:function(){return function(a){a.ui.selectAll()}},UnselectAll:function(){return function(a){a.ui.unselectAll()}},PageDown:function(){return function(a){a.ui.pageDown()}},ExtendPageDown:function(){return function(a){a.ui.extendPageDown()}},PageUp:function(){return function(a){a.ui.pageUp()}},ExtendPageUp:function(){return function(a){a.ui.extendPageUp()}},DeleteSelected:function(){return function(a){a.ui.deleteSelected()}},ShiftLock:function(){return function(a){a.key.lock("shiftKey")}},CtrlLock:function(){return function(a){a.key.lock("ctrlKey")}},
AltLock:function(){return function(a){a.key.lock("altKey")}},ShiftUnlock:function(){return function(a){a.key.unlock("shiftKey")}},CtrlUnlock:function(){return function(a){a.key.unlock("ctrlKey")}},AltUnlock:function(){return function(a){a.key.unlock("altKey")}},ShiftToggleLock:function(){return function(a){a.key.togglelock("shiftKey")}},CtrlToggleLock:function(){return function(a){a.key.togglelock("ctrlKey")}},AltToggleLock:function(){return function(a){a.key.togglelock("altKey")}},VisualModeOn:function(){return function(a){a.vim.visual.at(1)}},
VisualModeoff:function(){return function(a){a.vim.visual.at(0)}},ToggleHelp:function(){return function(a){a.ui.toggleHelp()}},ToggleAbout:function(){return function(a){a.ui.toggleAbout()}},ToggleConfig:function(){return function(a){a.ui.toggleConfig()}},DefaultEnter:function(){return function(a){a.ui.defaultEnter()}},ViewInformation:function(){return function(a){a.ui.viewInformation()}},Escape:function(){return function(a){a.ui.escape()}},FocusToggle:function(){return function(a){a.ui.focusToggle()}},
FocusToggleReverse:function(){return function(a){a.ui.focusToggleReverse()}},FullScreenOn:function(){return function(a){a.ui.fullScreenOn()}},FullScreenOff:function(){return function(a){a.ui.fullScreenOff()}},FullScreenToggle:function(){return function(a){a.ui.fullScreenToggle()}},FilterStart:function(){return function(a){a.ui.filterStart()}},Nop:function(){return function(){}},Define:function(){return function(){}}};if("undefined"!==typeof exports)exports.command=e;var x={"<space>":e.PlayPause(),
"<c-space>":"<space>","<c-right>":e.NextMusic(),"<c-left>":e.PreviousMusic(),"<c-o>":e.OpenFile(),":o":"<c-o>",":e":"<c-o>","<right>":e.SeekForward([10]),"<s-right>":e.SeekForward([30]),l:"<right>",w:"<s-right>","<left>":e.SeekBackward([10]),"<s-left>":e.SeekBackward([30]),h:"<left>",b:"<s-left>","<s-4>":e.SeekPercent([100]),"<c-r>":e.ToggleRepeat(),"<c-u>":e.ToggleShuffle(),"<c-up>":e.VolumeUp(),"<c-down>":e.VolumeDown(),"<c-a-down>":e.VolumeToggleMute(),9:e.VolumeDown(),"<down>":e.SelectDown(),
j:"<down>","<s-down>":e.ExtendDown(),"<s-j>":"<s-down>","<up>":e.SelectUp(),k:"<up>","<s-up>":e.ExtendUp(),"<s-k>":"<s-up>","<home>":e.SelectHome(),gg:"<home>","0":"<home>","<s-home>":e.ExtendToHome(),"<end>":e.SelectEnd(),"<s-g>":"<end>","<s-end>":e.ExtendToEnd(),"<c-a>":e.SelectAll(),"<c-s-a>":e.UnselectAll(),"<pgdn>":e.PageDown(),"<s-pgdn>":e.ExtendPageDown(),"<pgup>":e.PageUp(),"<c-b>":"<pgup>","<s-pdup>":e.ExtendPageUp(),"<s-/>":e.ToggleHelp(),"<f1>":e.ToggleAbout(),"[":"<f1>","<c-,>":e.ToggleConfig(),
"<delete>":e.DeleteSelected(),"<backspace>":"<delete>",d:"<delete>","<esc>":e.Escape(),"<s-esc>":"<esc>","<c-[>":"<esc>","<c-s-[>":"<esc>","<enter>":e.DefaultEnter(),"<a-enter>":e.ViewInformation(),"<tab>":e.FocusToggle(),"<s-tab>":e.FocusToggleReverse(),f:e.FullScreenToggle(),"<c-s-f>":e.FullScreenToggle(),"<c-f>":e.FilterStart(),"/":"<c-f>","<nop>":e.Nop()};if("undefined"!==typeof exports)exports.keyconfig=x;v.prototype={version:"2.0",start:function(){h("Player.prototype.start");this.key.start();
this.ui.start(this);this.repeat.init();this.shuffle.init();this.volume.init()},files:[],musics:[],tags:[],playing:null,nowplaying:0,filetypes:{audio:{regexp:/audio\/(mp3|wav|ogg|m4a|x-matroska)/,string:"audio"},video:{regexp:/video\/(mp4)/,string:"video"}},readFiles:function(a){h("Player.prototype.readFiles");var b=this;[].forEach.call(a,function(c,d){j("filetype: "+c.type);a[d].filetype=c.type.match(b.filetypes.audio.regexp)?b.filetypes.audio.string:c.type.match(b.filetypes.video.regexp)?b.filetypes.video.string:
""});[].forEach.call([].filter.call(a,function(a){return""!==a.filetype}),function(a,d,g){var f=setTimeout,e=void 0===b.shuffle.value||"false"===b.shuffle.value?0===d:d===parseInt(g.length/2),a=b.readOneFile(a,e,d===g.length-1);f(a,10*d)})},readOneFile:function(a,b,c){h("Player.prototype.readOneFile");var d=this.musics.length;this.files[d]=a;this.musics[d]=new w(a,"video"===a.filetype?this.ui.div.video:null);this.musics[d].tagread(function(a,b,c){return function(d){a.tags[b]=d;a.ui.ontagread(d,b);
c&&a.play()}}(this,d,!this.playing&&b));this.ui.addfile(a,d);this.order.concat([d]);c&&(this.ui.selectableSet(),this.ui.setdblclick(),"true"===this.order.shuffle.value&&this.order.shuffleOn())},play:function(a){h("Player.prototype.play");console.log("- player.prototype.play---");console.log("index: "+a);var b=this;void 0===a&&(a=0);console.dir(b.order);b.order.atfromEnum(a);b.pause();b.playing&&b.playing.release();if(void 0!==a)b.nowplaying=a,b.playing=b.musics[a],b.playing.play(b.volume.value/256,
function(){b.next()}),b.ui.play(a),"video"===b.playing.filetype?b.ui.popupvideo():b.ui.hidevideo()},pause:function(){h("Player.prototype.pause");this.ui.pause();this.playing&&this.playing.pause()},toggle:function(){h("Player.prototype.toggle");this.playing&&(this.playing.paused()?(this.playing.resume(),this.ui.play(this.nowplaying)):this.pause())},nextundefinedcount:0,next:function(){h("Player.prototype.next");console.dir(this.order);this.pause();var a=this.order.next();if(void 0===a){this.playing&&
this.playing.release();this.nextundefinedcount++;if(3>this.nextundefinedcount)return;this.nextundefinedcount=0;a=this.order.head()}this.play(a)},prevundefinedcount:0,prev:function(){h("Player.prototype.prev");this.pause();var a=this.order.prev();if(void 0===a){this.playing&&this.playing.release();this.prevundefinedcount++;if(3>this.prevundefinedcount)return;this.prevundefinedcount=0;a=this.order.last()}this.play(a)},seekAt:function(a){h("Player.prototype.seekAt");return void 0!==this.playing&&this.playing.audio?
(a=Math.max(0,Math.min(1,a)),this.playing.audio.currentTime=this.playing.audio.duration*a,!0):!1},seekBy:function(a){h("Player.prototype.seekBy");void 0!==this.nowplaying&&this.playing&&this.playing.audio&&this.playing.seekBy(a)&&this.prev()},volume:new r(0,256,16,127),updatevolume:function(){h("Player.prototype.updatevolume");this.volume.at(this.ui.getvolume())},mute:function(){h("Player.prototype.mute");this.prevol=this.volume.value;this.volume.setToMin()},resume:function(){h("Player.prototype.resume");
this.volume.at(this.prevol);delete this.prevol},togglemute:function(){h("Player.prototype.togglemute");this.ismute()?this.resume():this.mute()},ismute:function(){h("Player.prototype.ismute");return 0===this.volume.value&&void 0!==this.prevol},volumeup:function(){h("Player.prototype.volumeup");this.volume.increase()},volumedown:function(){h("Player.prototype.volumedown");this.volume.decrease()},remove:function(a){h("Player.prototype.remove");this[a]=null;j("removing:::"+a);this.order.remove(a);j(this.order);
j(this.order.array)},order:new k([],null,function(){}),repeat:new n(["false","true","one"]),shuffle:new n(["false","true"])};v.prototype.vim={visual:new n([!1,!0],!1,function(){})};var y=new v;window.onload=function(){y.start()}})();
