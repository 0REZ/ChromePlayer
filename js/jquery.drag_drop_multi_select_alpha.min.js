(function(a){var d;a.fn.exists=function(){return 0==jQuery(this).length?!1:!0};a.fn.drag_drop_multi_select=function(b){var c=a.fn.drag_drop_multi_select.defaults;b&&(c=a.extend(a.fn.drag_drop_multi_select.defaults,b));return this.each(function(){var b=a.fn.drag_drop_multi_select.unique++;d=a(this);d.attr("ddms",b);a.fn.captureKeys();a.fn.drag_drop_multi_select.stack[b]={selected:[],all:[]};a.fn.drag_drop_multi_select.settings[b]=c;d.find(c.element_to_drag_drop_select).each(function(){var f=a(this),
e=a.fn.drag_drop_multi_select.unique++;f.attr("ddms",e);a.fn.drag_drop_multi_select.settings["item_"+f.attr("ddms")]={self:f,parent_to_refer:d};a.fn.drag_drop_multi_select.stack[b].all.push(e);f.bind("click.ddms_item_clicked",function(b){a(".last-select").removeClass("last-select");b.ctrlKey?a.fn.drag_drop_multi_select.toggle(e):a.fn.drag_drop_multi_select.replace(e)});f.bind("ddms.select",function(){a(this).addClass("ui-selected");a(this).addClass(a.fn.drag_drop_multi_select.settings[a.fn.drag_drop_multi_select.get_instance_id(a(this).attr("ddms"))].selectedClass);
a(this).addClass("last-select");0==d.find(".ui-selected").size()?a(c.element_to_show_result).text(""):a(c.element_to_show_result).text(d.find(".ui-selected").size()+" items are selected")});f.bind("ddms.deselect",function(){a(this).removeClass("ui-selected");a(this).removeClass(a.fn.drag_drop_multi_select.settings[a.fn.drag_drop_multi_select.get_instance_id(a(this).attr("ddms"))].selectedClass);0==d.find(".ui-selected").size()?a(c.element_to_show_result).text(""):a(c.element_to_show_result).text(d.find(".ui-selected").size()+
" items are selected")})});d.selectable({cancel:"'"+c.elements_to_cancel_select+","+c.element_to_drag_drop_select+"'",filter:d.find(c.element_to_drag_drop_select),selecting:function(){0==d.find(".ui-selecting").size()?a(c.element_to_show_result).text(""):a(c.element_to_show_result).text(d.find(".ui-selecting").size()+" items are in the selection")},unselecting:function(){0==d.find(".ui-selecting").size()?a(c.element_to_show_result).text(""):a(c.element_to_show_result).text(d.find(".ui-selecting").size()+
" items are in the selection")},stop:function(){0==d.find(".ui-selected").size()?a(c.element_to_show_result).text(""):a(c.element_to_show_result).text(d.find(".ui-selected").size()+" items are selected")},selected:function(b,c){a.fn.drag_drop_multi_select.select(parseInt(a(c.selected).attr("ddms")))},unselected:function(b,c){a.fn.drag_drop_multi_select.deselect(parseInt(a(c.unselected).attr("ddms")))}});d.find(c.element_to_drag_drop_select).draggable({helper:function(){$clicked_item=a(this);$clicked_item.hasClass("ddms_selected")||
$clicked_item.trigger("click.ddms_item_clicked");var b=a.fn.drag_drop_multi_select.get_instance_id($clicked_item.attr("ddms")),c=a('<div ddms_instance="'+b+'"></div>').append('<div class="inside_helper" style="position:absolute;top:-'+a.fn.drag_drop_multi_select.getTopOffset($clicked_item)+"px;left:-"+a.fn.drag_drop_multi_select.getLeftOffset($clicked_item)+'px;" ></div>');c.find(".inside_helper").append(a.fn.drag_drop_multi_select.getSelectedForDragging($clicked_item.attr("ddms")));a.fn.drag_drop_multi_select.getListItems(b).filter(a.fn.drag_drop_multi_select.settings[b].selectedClass).addClass(a.fn.drag_drop_multi_select.settings[b].ghostClass);
return c},cursor:"move",revert:"invalid",scroll:!1,start:function(){},drag:function(b,c){a.fn.drag_drop_multi_select.defaults.while_dragging_action(b,c)},stop:function(){$clicked_item=a(this);var b=a.fn.drag_drop_multi_select.get_instance_id($clicked_item.attr("ddms"));a.fn.drag_drop_multi_select.getListItems(b).filter(a.fn.drag_drop_multi_select.settings[b].selectedClass).removeClass(a.fn.drag_drop_multi_select.settings[b].ghostClass)}});var h=[];a(c.elements_to_drop).droppable({tolerance:"pointer",
over:function(d,e){var g=a(d.target),i=parseInt(e.helper.attr("ddms_instance"));h=[];a.fn.drag_drop_multi_select.getListItems(i).filter(c.selectedClass).each(function(){h.push(a(this).attr("ddms"))});a.inArray(g.attr("ddms"),h);g.addClass(a.fn.drag_drop_multi_select.settings[b].hoverClass);g=a(d.target)},out:function(c){a(c.target).removeClass(a.fn.drag_drop_multi_select.settings[b].hoverClass)},drop:function(d,e){a(d.target).removeClass(a.fn.drag_drop_multi_select.settings[b].hoverClass);var g=parseInt(e.helper.attr("ddms_instance"));
e.helper.find(".inside_helper ."+c.selectedClass).each(function(){var c=parseInt(a(this).attr("ddms_drag"));a.fn.drag_drop_multi_select.moveBetweenLists(c,a.fn.drag_drop_multi_select.settings["item_"+c].self,g,b,d,e)})}})})};a.fn.drag_drop_multi_select.defaults={element_to_drag_drop_select:".ddms",elements_to_cancel_select:".cancel",elements_to_drop:".drop",element_to_show_result:".items_selected",moveOpacity:0.5,ghostClass:"ddms_ghost",hoverClass:"ddms_hover",moveClass:"ddms_move",selectedClass:"ddms_selected",
after_drop_action:function(){},while_dragging_action:function(){}};a.fn.drag_drop_multi_select.unique=0;a.fn.drag_drop_multi_select.stack=[];a.fn.drag_drop_multi_select.settings=[];a.fn.drag_drop_multi_select.moveBetweenLists=function(b,c,d,h,f,e){var g=a.fn.drag_drop_multi_select.get_instance_id(b);a.fn.drag_drop_multi_select.deselect(parseInt(b));a(a.fn.drag_drop_multi_select.settings[g].element_to_show_result).text("");var i=a("[ddms="+d+"]"),j=a("[ddms="+h+"]");a.fn.drag_drop_multi_select.settings[g].after_drop_action(c,
i,j,f,e);a.fn.drag_drop_multi_select.stack[d].all.splice(a.inArray(parseInt(b),a.fn.drag_drop_multi_select.stack[d].all),1);a.fn.drag_drop_multi_select.stack[h].all.push(parseInt(b))};a.fn.drag_drop_multi_select.getSelectedForDragging=function(b){var c=a.fn.drag_drop_multi_select.get_instance_id(b);return a.fn.drag_drop_multi_select.getListItems(c).clone().each(function(){var b=a(this).attr("ddms");a(this).not("."+a.fn.drag_drop_multi_select.settings[c].selectedClass).hide();a(this).filter("."+a.fn.drag_drop_multi_select.settings[c].selectedClass).addClass(a.fn.drag_drop_multi_select.settings[c].moveClass).css({opacity:a.fn.drag_drop_multi_select.settings[c].moveOpacity});
a(this).attr("ddms_drag",a(this).attr("ddms"));a(this).attr("ddms","");a(this).css({position:"absolute",left:a('[ddms="'+b+'"]').position().left,top:a('[ddms="'+b+'"]').position().top})})};a.fn.drag_drop_multi_select.getTopOffset=function(b){var c=b.position().top;a.fn.drag_drop_multi_select.getListItems(a.fn.drag_drop_multi_select.get_instance_id(b.attr("ddms"))).eq(0).position();return c};a.fn.drag_drop_multi_select.getLeftOffset=function(b){var c=b.position().left;a.fn.drag_drop_multi_select.getListItems(a.fn.drag_drop_multi_select.get_instance_id(b.attr("ddms"))).eq(0).position();
return c};a.fn.drag_drop_multi_select.toggle=function(b){a.fn.drag_drop_multi_select.isSelected(b)?a.fn.drag_drop_multi_select.deselect(b):a.fn.drag_drop_multi_select.select(b)};a.fn.drag_drop_multi_select.select=function(b){var c=a.fn.drag_drop_multi_select.get_instance_id(b),d=a.fn.drag_drop_multi_select.settings["item_"+b].self;a.fn.drag_drop_multi_select.isSelected(b)||(a.fn.drag_drop_multi_select.stack[c].selected.push(b),d.trigger("ddms.select"))};a.fn.drag_drop_multi_select.deselect=function(b){var c=
a.fn.drag_drop_multi_select.get_instance_id(b),d=a.fn.drag_drop_multi_select.settings["item_"+b].self;a.fn.drag_drop_multi_select.isSelected(b)&&(a.fn.drag_drop_multi_select.stack[c].selected.splice(a.inArray(b,a.fn.drag_drop_multi_select.stack[c].selected),1),d.trigger("ddms.deselect"))};a.fn.drag_drop_multi_select.isSelected=function(b){var c=a.fn.drag_drop_multi_select.settings["item_"+b].self,b=a.fn.drag_drop_multi_select.get_instance_id(b);return c.hasClass(a.fn.drag_drop_multi_select.settings[b].selectedClass)};
a.fn.drag_drop_multi_select.replace=function(b){var c=a.fn.drag_drop_multi_select.get_instance_id(b);a.fn.drag_drop_multi_select.selectNone(c);a.fn.drag_drop_multi_select.stack[c].selected.push(b);a.fn.drag_drop_multi_select.settings["item_"+b].self.trigger("ddms.select")};a.fn.drag_drop_multi_select.getListItems=function(b){return a("[ddms="+b+"] "+a.fn.drag_drop_multi_select.settings[b].element_to_drag_drop_select)};a.fn.drag_drop_multi_select.get_instance_id=function(b){return parseInt(a.fn.drag_drop_multi_select.settings["item_"+
b].parent_to_refer.eq(0).attr("ddms"))};a.fn.drag_drop_multi_select.serializeArray=function(b){var c=[];a.fn.drag_drop_multi_select.getListItems(b).each(function(){c.push(a(this).attr("id"))});return c};a.fn.drag_drop_multi_select.serialize=function(b){return a.fn.drag_drop_multi_select.serializeArray(b).join(", ")};a.fn.drag_drop_multi_select.selectNone=function(b){a.fn.drag_drop_multi_select.getListItems(b).each(function(){a.fn.drag_drop_multi_select.deselect(a(this).attr("ddms"))});return!1};a.fn.drag_drop_multi_select.selectAll=
function(b){a.fn.drag_drop_multi_select.getListItems(b).each(function(){a.fn.drag_drop_multi_select.select(a(this).attr("ddms"))});return!1};a.extend({ddms:{selectAll:function(b){return a.fn.drag_drop_multi_select.selectAll(a("#"+b).attr("ddms"))},selectNone:function(b){return a.fn.drag_drop_multi_select.selectNone(a("#"+b).attr("ddms"))},serialize:function(b){return a.fn.drag_drop_multi_select.serialize(a("#"+b).attr("ddms"))}}});a.fn.captureKeys=function(){a.fn.captureKeys.capturing||(a(document).keydown(function(b){if(17==
b.keyCode)a.fn.captureKeys.stack.CTRL_KEY=!0;if(16==b.keyCode)a.fn.captureKeys.stack.SHIFT_KEY=!0;if(18==b.keyCode)a.fn.captureKeys.stack.ALT_KEY=!0}),a(document).keyup(function(b){if(17==b.keyCode)a.fn.captureKeys.stack.CTRL_KEY=!1;if(16==b.keyCode)a.fn.captureKeys.stack.SHIFT_KEY=!1;if(18==b.keyCode)a.fn.captureKeys.stack.ALT_KEY=!1}))};a.fn.captureKeys.stack={CTRL_KEY:!1,SHIFT_KEY:!1,ALT_KEY:!1};a.fn.captureKeys.capturing=!1;a.fn.keyisPressed=function(b){switch(b){case 17:return a.fn.captureKeys.stack.CTRL_KEY;
case 18:return a.fn.captureKeys.stack.ALT_KEY;case 16:return a.fn.captureKeys.stack.SHIFT_KEY;default:return!1}}})(jQuery);
