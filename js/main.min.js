/*!
 *       Chrome Player v1.58
 *             created by itchyny
 *
 *     Work on Google Chrome 9.0
 *     Copyright (c) 2011 itchyny
 *
 *     Last Modified: Fri, 29 Apr 2011 09:50:05 GMT
 *
 */
(function(){var d={d:{version:"1.58"}},h=null,k=localStorage,f=jQuery,e=function(b,d){b.forEach(function(b){d[b]=f("#"+b)});return d}(["about","conf","config","current","filename","fileselect","firstrow","globalcontrol","help","musicSlider","mute","next","open","pause","play","playlist","prev","property","remain","repeat","scheme","shuffle","tablebody","tablediv","tagread","volumeSlider","volumeon","wrapper","filter","filterword","matchnum"],{tbody:f("#tbody"),thead:f("thead"),table:f("table")});
f(function(){d.ui.set();d.v.set();d.k.set();d.r.set();d.sh.set();d.st.set();d.st.colorset()});(function(){k.globalcontrol===void 0?k.globalcontrol=d.d.globalcontrol="true":d.d.globalcontrol=k.globalcontrol;k.tagread===void 0?k.tagread=d.d.tagread="true":d.d.tagread=k.tagread;chrome.extension&&chrome.extension.onRequest.addListener(function(b){if(d.d.globalcontrol!=="false"){var f=d.k;switch(b.keyCode){case 32:f.space(b);break;case 37:f.left(b);break;case 38:f.up(b);break;case 39:f.right(b);break;
case 40:f.down(b);break;case 173:case 119:f.f8(b);break;case 174:case 120:f.f9(b);break;case 175:case 121:f.f10(b);break;case 176:f.media_next_track(b);break;case 177:f.media_prev_track(b);break;case 178:f.media_stop(b);break;case 179:f.media_play_pause(b)}}});String.prototype.toBin=function(){var b=Array.prototype.push,d=Array.prototype.join;return function(){for(var f=[],a=9,i=this;--a;)b.call(f,i&128),i<<=1;return d.call(f,"")}}();String.prototype.unsynchsafe=function(){var b=String.prototype.charCodeAt;
return function(){return(b.call(this,0)&127)<<21|(b.call(this,1)&127)<<14|(b.call(this,2)&127)<<7|b.call(this,3)&127}}();Array.prototype.shuffle=function(){var b=Math.random,d=Math.floor;return function(){for(var f=this.length,a,i;f;)a=d(b()*f),i=this[--f],this[f]=this[a],this[a]=i;return this}}();Array.prototype.unique=function(){var b=[],d,f,a,i,e;d=-1;for(a=this.length;++d<a;){f=-1;i=b.length;for(e=!0;++f<i;)b[f]===this[d]&&(f=i+1,e=!1);e&&b.push(this[d])}return b};f.fn.unique=Array.prototype.unique;
f.fn.join=Array.prototype.join;f.fn.texttitle=function(b){return this.text(b).attr("title",b)};f.fn.S=function(){return function(b,d){if(this.size()){this.addClass("ui-selected ddms_selected");if(b)return this;var f=this.offset().top,a=e.tablebody.offset().top,i=f-30-a,f=f+60-e.tablediv.height()-a;i<0?d?e.tablebody.animate({scrollTop:"+="+i},{duration:"fast",easing:"linear"}):e.tablebody.scrollTop(e.tablebody.scrollTop()+i):f>0&&(d?e.tablebody.animate({scrollTop:"+="+f},{duration:"fast",easing:"linear"}):
e.tablebody.scrollTop(e.tablebody.scrollTop()+f))}return this}}();f.fn.U=function(b){b||this.S();return this.removeClass("ui-selected ddms_selected last-select")};f.fn.L=function(b){b||f("tr.last-select",e.tbody).removeClass("last-select");return this.addClass("last-select")};f.fn.I=function(){return this.hasClass("ui-selected")};f.fn.drag_drop_multi_select.defaults.after_drop_action=function(b,j,g,a){var j=b.first().attr("number"),i=f("tr",e.tbody).first().height()/2,m=a.clientY,a=f("tr",e.tbody).filter(function(){var a=
m-f(this).offset().top;return-i<=a&&a<i}).first();j===a.attr("number")&&(a=b.last().next());b.insertBefore(a).addClass("ui-selected moved");setTimeout(d.ui.selectableSet,30);setTimeout(function(){f("tr.ui-selected",e.tbody).removeClass("ui-selected moved last-select");d.o.set()},1E3)}})();d.ui={set:function(){f("div#appname a").text("Chrome Player v"+d.d.version);f(window).resize(d.st.set);document.body.ondragover=function(b){b.preventDefault()};document.body.ondrop=function(b){b.preventDefault();
d.c.readFiles(b.dataTransfer.files)};e.help.click(function(){e.help.fadeOut(200);d.k.tab(0)});e.config.click(function(b){["a","input"].indexOf(b.target.localName)<0&&(e.config.fadeOut(200),d.k.tab(0))});e.about.click(function(b){b.target.localName!=="a"&&(e.about.fadeOut(200),d.k.tab(0))});e.property.click(function(b){b.target.localName!=="a"&&(e.property.fadeOut(200),d.k.tab(0))});f("img.lbutton, img.rbutton").mouseup(function(){f(this).css({top:""})}).mousedown(function(){f(this).css({top:parseInt(f(this).css("top"),
10)*1.03+"%"})});e.fileselect.change(function(b){d.c.readFiles(b.target.files)});e.open.click(function(){e.fileselect.click()});e.play.click(d.a.toggle);e.pause.click(d.a.toggle);e.prev.click(d.a.prev);e.next.click(d.a.next);e.mute.click(d.v.mute);e.volumeon.click(d.v.on);e.repeat.click(d.r.toggle);e.shuffle.click(d.sh.toggle);e.conf.click(function(){e.config.fadeToggle(200)});e.thead.find("th").each(function(b){f(this).click(function(){var f=1;return function(){d.o.sort(b,f);f*=-1}}())});e.filename.click(function(){f("tr.ui-selected").U();
f("tr.nP").S().L();d.k.tab(0)});e.globalcontrol.attr({checked:d.d.globalcontrol==="true"}).change(function(b){k.globalcontrol=d.d.globalcontrol=b.target.checked.toString()});e.tagread.attr({checked:d.d.tagread==="true"}).change(function(b){k.tagread=d.d.tagread=b.target.checked.toString()});e.volumeSlider.slider({min:0,max:256,step:8,slide:d.v.update,stop:d.v.update});e.musicSlider.slider({min:0,max:1,step:0.01,start:d.i.startSlide,stop:d.i.stopSlide}).slider("disable");e.filterword.keydown(d.f.start);
d.ui.selectableSet();d.ui.resizableSet()},resizableSet:function(){var b=function(){var b=[],d={},a=e.thead.width();f("th:not(.splitter)").each(function(i){var e=f(this).width()/(a-0);b.push("td:nth-child("+(i+1)+") {width:"+e*100+"%!important;}");d[f(this).attr("class")]=e});k.splitter=JSON.stringify(d)};setTimeout(b,10);return function(){f("th:not(.splitter)+th:not(.splitter)",e.thead).each(function(){var d=!1,e=f("<th />",{"class":"splitter"}).mousedown(function(){d=!0}).insertBefore(f(this));f(window).mouseup(function(){d&&
(d=!1,b())}).mousemove(function(a){if(d){var b=e.prev().width()+e.next().width();e.prev().width(a=-e.prev().offset().left+a.clientX);e.next().width(b-a)}})})}}(),selectableSet:function(){var b=e.tbody.width();f("tr",e.tbody).each(function(){var j=f(this),g=f("<tr />").attr({number:j.attr("number")}).append(j.children()).dblclick(d.a.playThis).click(function(a){var b=f("tr.last-select");if(a.shiftKey&&!a.altKey&&b.size()){if(a.ctrlKey){var d=f("tr.ui-selected");setTimeout(function(){d.S(!0)},20)}a.clientY<
b.position().top?setTimeout(function(){b.S(!0).L().prevAll().filter(function(){return f(this).position().top>a.clientY}).S(!0)},20):setTimeout(function(){b.S(!0).L().nextAll().filter(function(){return f(this).position().top<a.clientY}).S(!0)},20)}}).width(b).addClass(j.hasClass("nP")?"nP":"").addClass(j.hasClass("moved")?"ui-selected moved":"").addClass(j.hasClass("ui-selected")?"ui-selected":"").appendTo(e.tbody);j.I()&&setTimeout(function(){g.S(!0)},30)}).remove();f.fn.drag_drop_multi_select.unique=
0;f.fn.drag_drop_multi_select.stack=[];f.fn.drag_drop_multi_select.settings=[];e.tbody.drag_drop_multi_select({element_to_drag_drop_select:"tr, D.tbody",elements_to_drop:e.tbody,moveOpacity:0.7})}};d.k=function(){var b=function(a){return(a.global?"g":"")+(a.ctrlKey||a.metaKey?"c":"")+(a.shiftKey?"s":"")+(a.altKey?"a":"")},j=function(a){var b=e[a]||f("img#"+a);b.mousedown().click();setTimeout(function(){b.mouseup()},200)},g=function(a){a.preventDefault&&a.preventDefault()};return{set:function(){var a=
d.k;f(window).keydown(function(e){if(f("#filter:visible").size())switch(e.keyCode){case 27:a.esc(e);break;case 13:g(e);d.f.blink();break;case 70:switch(b(e)){case "c":g(e),d.f.set()}}else switch(e.keyCode){case 9:a.tab(e);break;case 13:a.enter(e);break;case 27:a.esc(e);break;case 32:a.space(e);break;case 33:a.pgup(e);break;case 34:a.pgdn(e);break;case 35:a.end(e);break;case 36:a.home(e);break;case 37:a.left(e);break;case 38:a.up(e);break;case 39:a.right(e);break;case 40:a.down(e);break;case 8:case 46:a.del(e);
break;case 65:a.a(e);break;case 70:a.f(e);break;case 79:a.o(e);break;case 82:a.r(e);break;case 85:a.u(e);break;case 112:a.f1(e);break;case 173:case 119:a.f8(e);break;case 174:case 120:a.f9(e);break;case 175:case 121:a.f10(e);break;case 191:a.question(e);break;case 176:a.media_next_track(e);break;case 177:a.media_prev_track(e);break;case 178:a.media_stop(e);break;case 179:a.media_play_pause(e)}})},f:function(a){g(a);switch(b(a)){case "c":d.f.set()}},media_next_track:function(a){g(a);j("next")},media_prev_track:function(a){g(a);
j("prev")},media_stop:function(a){g(a);d.a.pause()},media_play_pause:function(a){g(a);j("play")},f1:function(a){switch(b(a)){case "":g(a),e.about.fadeToggle(200)}},f8:function(a){switch(b(a)){case "g":case "":if(h===null){d.v.toggleMute();break}j(h.volume?"mute":"volumeon")}},f9:function(a){switch(b(a)){case "g":case "":g(a),d.v.down()}},f10:function(a){switch(b(a)){case "g":case "":g(a),d.v.up()}},pgup:function(a){switch(b(a)){case "":g(a);e.tablebody.scrollTop(e.tablebody.scrollTop()-e.tablebody.height()*
0.8);f("tr.ui-selected").U(!0);f("tr",e.tbody).filter(function(){return f(this).position().top>0}).first().S().L();break;case "s":g(a);e.tablebody.scrollTop(e.tablebody.scrollTop()-e.tablebody.height()*0.8);var d=window.innerHeight,a=f("tr.last-select",e.tbody);a.next().I()?f("tr.ui-selected").filter(function(){return f(this).position().top>d-50}).U(!0):a.prevAll().filter(function(){return f(this).position().top>0}).S(!0).last().S()}},pgdn:function(a){switch(b(a)){case "":g(a);e.tablebody.scrollTop(e.tablebody.scrollTop()+
e.tablebody.height()*0.8);f("tr.ui-selected").U(!0);var d=window.innerHeight;f("tr",e.tbody).filter(function(){return f(this).position().top<d}).last().S().L();break;case "s":g(a),e.tablebody.scrollTop(e.tablebody.scrollTop()+e.tablebody.height()*0.8),f("tr.last-select").prev().I()?f("tr.ui-selected").filter(function(){return f(this).position().top<e.thead.position().top+40}).U(!0):(d=window.innerHeight,f("tr.last-select").nextAll().filter(function(){return f(this).position().top<d}).S(!0).last().S())}},
question:function(a){switch(b(a)){case "s":e.help.fadeToggle(200),f("div#help:hidden").size()&&e.tablebody.focus()}},tab:function(){var a=0;return function(d){typeof d==="number"?a=2+d:g(d);switch(b(d)){case "s":++a;case "":++a,a%=3,[e.tbody,f("div#musicSlider a"),f("div#volumeSlider a")][a].focus(),a===0&&(f("tr.ui-selected").first().S().size()||f("tr.nP").S().L())}}}(),space:function(a){switch(b(a)){case "gc":case "ga":case "c":case "a":case "":g(a),j("play")}},o:function(a){switch(b(a)){case "c":g(a),
j("open")}},a:function(a){switch(b(a)){case "c":g(a);e.tbody.children().S(!0).last().L();break;case "cs":g(a),e.tbody.children().U(!0)}},r:function(a){switch(b(a)){case "c":g(a),j("repeat")}},u:function(a){switch(b(a)){case "c":g(a),j("shuffle")}},end:function(a){g(a);switch(b(a)){case "s":f("tr.ui-selected").removeClass("ui-selected ddms_selected");f("tr.last-select").S(!0).nextAll().S(!0).last().S();break;case "":f("tr.ui-selected").U(!0),e.tbody.children().last().S().L()}},home:function(a){g(a);
switch(b(a)){case "s":f("tr.ui-selected").removeClass("ui-selected ddms_selected");f("tr.last-select").S(!0).prevAll().S(!0).last().S();break;case "":f("tr.ui-selected").U(!0),e.tbody.children().first().S().L()}},esc:function(a){g(a);switch(b(a)){case "":switch(f("#help:visible,#config:visible,#about:visible,#property:visible,#filter:visible").size()){case 0:f("div#musicSlider a:focus, div#volumeSlider a:focus").size()?(d.k.tab(0),f("div#musicSlider a, div#volumeSlider a").focusout()):f("tr.ui-selected").U(!0);
break;default:e.config.add(e.help).add(e.property).add(e.about).filter(function(){return f(":visible",this).size()}).last().fadeOut(200),d.f.end()}}},enter:function(a){g(a);switch(b(a)){case "":switch(f("div#help:visible,div#config:visible,div#about:visible,div#property:visible").size()){case 0:d.a.playThis(f("tr.ui-selected").U(!0).first().children().first());return;default:e.config.add(e.help).add(e.property).add(e.about).filter(function(){return f(":visible",this).size()}).last().fadeOut(200);
return}case "a":if(e.property.fadeIn(200),d.d.tagread==="true"&&d.d.tags){var a={TALB:"album",TIT2:"title",TPE1:"artist",TRCK:"track",TDRC:"year"},i=f("tr.ui-selected").map(function(a,b){return d.d.tags[parseInt(f(b).attr("number"),10)]}),m;for(m in a)f("dd#id"+a[m]).text("\u3000"+i.map(function(a,b){return b[m]}).unique().join())}}},up:function(a){g(a);switch(b(a)){case "gc":case "c":d.v.up();break;case "s":case "cs":g(a);var i=f("tr.last-select");i.size()&&(i.next().I()?i.nextAll().filter(function(){var a=
!0;return function(){return a&&(a=f(this).I())}}()).last().U():i.prevAll().filter(function(){var a=!0;return function(){return a&&(a=f(this).next().I())}}()).last().S());break;case "":var m=f("tr.ui-selected"),i=f("tr.last-select");g(a);m.size()?m.U(!0).prev().andSelf().first().S().L():i.size()?i.first().S().L():f("tr.nP").prev().andSelf().first().S().L().size()||f("tr",e.tbody).last().S().L()}},down:function(a){g(a);switch(b(a)){case "gc":case "c":d.v.down();break;case "gca":case "ca":if(h===null){d.v.toggleMute();
break}j(h.volume?"mute":"volumeon");break;case "s":case "cs":a=f("tr.last-select");a.size()&&(a.prev().I()?a.prevAll().filter(function(){var a=!0;return function(){return a&&(a=f(this).I())}}()).last().U():a.nextAll().filter(function(){var a=!0;return function(){return a&&(a=f(this).prev().I())}}()).last().S());break;case "":g(a);var i=f("tr.ui-selected"),a=f("tr.last-select");i.size()?i.U(!0).next().andSelf().last().S().L():a.size()?a.last().S().L():f("tr.nP").next().andSelf().last().S().L().size()||
f("tr",e.tbody).first().S().L()}},left:function(a){if(!f("a:focus",e.volumeSlider).size())switch(g(a),b(a)){case "":d.a.seekBy(-10);break;case "s":d.a.seekBy(-30);break;case "a":case "gc":case "c":j("prev")}},right:function(a){if(!f("a:focus",e.volumeSlider).size())switch(g(a),b(a)){case "":d.a.seekBy(10);break;case "s":d.a.seekBy(30);break;case "a":case "gc":case "c":j("next")}},del:function(a){g(a);f("tr.ui-selected").last().next().L();f("tr.ui-selected").first().prev().L(!0);f("tr.ui-selected").remove();
d.o.set()}}}();d.st=function(){var b;k.splitter===void 0?b={now:0.05,filename:0.1,artist:0.2,title:0.3,track:0.05,album:0.25}:(b=JSON.parse(k.splitter),b.now=0.05);for(var j in b)f("th."+j).width(b[j]*e.thead.width());var g={"classic-default":{"background-color":{"div#wrapper":"#aaa","div#info":"#eee","div#playlist":"#fff","thead tr":"#ddd","div#musicSlider":"#aaa","div#musicSlider a":"#666","div#musicSlider a:focus":"#333","div#volumeSlider":"#eee","tbody tr:nth-child(odd) ":"#fff","tbody tr:nth-child(even) ":"#ddf",
"tbody tr.nP":"#aaf","tbody tr.ui-selected":"#08f"},color:{"tbody tr.ui-selected":"#fff"}},"classic-pink":{"background-color":{"div#wrapper":"#f66","div#info":"#fbb","thead tr":"#f99","div#musicSlider":"#f66","div#musicSlider a":"#844","div#musicSlider a:focus":"#622","div#volumeSlider":"#f88","tbody tr:nth-child(odd) ":"#fdd","tbody tr:nth-child(even) ":"#fbb","tbody tr.nP":"#f77","div#playlist":"#fdd","tbody tr.ui-selected":"#f22"},color:{"tbody tr.ui-selected":"#fff"}},"classic-yellow":{"background-color":{"div#wrapper":"#ff0",
"div#info":"#ff8","thead tr":"#ff8","div#musicSlider":"#ff0","div#musicSlider a":"#880","div#musicSlider a:focus":"#640","div#volumeSlider":"#ff8","tbody tr:nth-child(odd) ":"#ff7","tbody tr:nth-child(even) ":"#ff6","tbody tr.nP":"#ff4","div#playlist":"#ffb","tbody tr.ui-selected":"#ff0"},color:{"tbody tr.ui-selected":"#000!important"}},"classic-orange":{"background-color":{"div#wrapper":"#f80","div#info":"#fb8","thead tr":"#fb8","div#musicSlider":"#f80","div#musicSlider a":"#840","div#musicSlider a:focus":"#620",
"div#volumeSlider":"#fb8","tbody tr:nth-child(odd) ":"#ff8","tbody tr:nth-child(even) ":"#fd6","tbody tr.nP":"#fa0","div#playlist":"#fdb","tbody tr.ui-selected":"#f60"},color:{"tbody tr.ui-selected":"#000"}},"classic-lime":{"background-color":{"div#wrapper":"#6f6","div#info":"#bfb","div#playlist":"#fff","thead tr":"#9f9","div#musicSlider":"#6f6","div#musicSlider a":"#484","div#musicSlider a:focus":"#262","div#volumeSlider":"#8f8","tbody tr:nth-child(odd) ":"#dfd","tbody tr:nth-child(even) ":"#bfb",
"tbody tr.nP":"#7f7","div#playlist":"#dfd","tbody tr.ui-selected":"#2f2"},color:{"tbody tr.ui-selected":"#fff"}},"classic-lblue":{"background-color":{"div#wrapper":"#66f","div#info":"#bbf","thead tr":"#99f","div#musicSlider":"#66f","div#musicSlider a":"#448","div#musicSlider a:focus":"#226","div#volumeSlider":"#88f","tbody tr:nth-child(odd) ":"#ddf","tbody tr:nth-child(even) ":"#bbf","tbody tr.nP":"#77f","div#playlist":"#ddf","tbody tr.ui-selected":"#22f"},color:{"tbody tr.ui-selected":"#fff"}},"classic-purple":{"background-color":{"div#wrapper":"#f0f",
"div#info":"#f8f","thead tr":"#f8f","div#musicSlider":"#f0f","div#musicSlider a":"#808","div#musicSlider a:focus":"#604","div#volumeSlider":"#f8f","tbody tr:nth-child(odd) ":"#f7f","tbody tr:nth-child(even) ":"#f6f","tbody tr.nP":"#f4f","div#playlist":"#fbf","tbody tr.ui-selected":"#f0f"},color:{"tbody tr.ui-selected":"#000"}},"classic-dark":{"background-color":{"div#wrapper":"#000","div#info":"#333","thead tr":"#333","div#musicSlider":"#000","div#musicSlider a":"#666","div#musicSlider a:focus":"#999",
"div#volumeSlider":"#333","div#volumeSlider a":"#666","div#volumeSlider a:focus":"#666","tbody tr:nth-child(odd) ":"#222","tbody tr:nth-child(even) ":"#292929","tbody tr.nP":"#444","div#playlist":"#111","tbody tr.ui-selected":"#080808"},color:{"div#wrapper":"#fff"}}},a="classic-default",i=null,m;for(m in g)f("<a />").attr("scheme",m).css({color:g[m].color["div#wrapper"]||"black","background-color":g[m]["background-color"]["div#wrapper"]}).addClass(a===m?"currentScheme":"").click(function(){d.st.themeset(f(this).attr("scheme"))}).appendTo(e.scheme);
return{set:function(){d.k.tab(0);var a=e.tbody.width(),b=12*(window.innerWidth-1280)/2360+12;e.wrapper.css({"font-size":b});e.playlist.height(window.innerHeight-e.playlist.offset().top-b);e.tablediv.height(window.innerHeight-e.tablediv.offset().top-b);e.tablebody.height(window.innerHeight-e.tablebody.offset().top-b);e.play.attr(h!==null&&h.paused?{src:"./img/play.png",title:"Play"}:{src:"./img/pause.png",title:"Pause"});f("tr").css({width:a})},themeset:function(b){if(b in g)a=b,k.scheme=b,d.st.colorset()},
colorset:function(){a=k.scheme||"classic-default";i=g[a];f("a.currentScheme").removeClass("currentScheme");f("a[scheme="+a+"]").addClass("currentScheme");var b=[],d;for(d in i)for(var e in i[d])b.push(e+" { "+d+":"+i[d][e]+";}");f("style#sch").text(b.join("\n")).size()||f("<style />",{id:"sch"}).text(b.join("\n")).appendTo(f("head"))}}}();d.v=function(){var b=128,f=function(){return parseInt(e.volumeSlider.slider("value"),10)},g=function(a){e.volumeSlider.slider({value:a})},a=function(a){if(h)h.volume=
a/256},i=function(a){if(k&&!isNaN(a)&&typeof a==="number"&&0<=a&&a<=256)k.volume=a};return{set:function(){b=function(){var a=parseInt(k.volume,10);return k&&a!==void 0&&!isNaN(k.volume)&&0<=a&&a<=256?a:128}();a(b);g(b)},update:function(){b=f();a(b);i(b)},mute:function(){b=f();a(0);g(0);i(0)},on:function(){a(b);g(b);i(b)},toggleMute:function(){if(f()===0)d.v.on();else d.v.mute()},up:function(){b=Math.min(b+16,256);a(b);g(b);i(b)},down:function(){b=Math.max(b-16,0);a(b);g(b);i(b)}}}();d.a={play:function(){if(h!==
null&&d.d.nP>=0)h.play(),d.st.set(),clearInterval(d.d.seek),d.d.seek=setInterval(d.i.seek,500),e.musicSlider.slider("enable")},playThis:function(b){if(h!==null){if(h.duration)h.currentTime=0,d.i.seek();d.a.pause();d.c.play(parseInt(f(b.target).closest("tr").attr("number")||b.closest("tr").attr("number")||b.attr("number"),10))}},pause:function(){h!==null&&(h.pause(),d.st.set(),clearInterval(d.d.seek))},next:function(){d.a.pause();if(h!==null&&d.r.get()==="one"&&h.duration){h.currentTime=0;d.a.play();
var b=f("tr.ui-selected");b.size()<2&&(b.U(!0),f("tr.nP").S().L())}else{if(h!==null&&h.duration)h.currentTime=0,d.i.seek();b=d.d.order[d.d.nP+1];b!==void 0&&b>=0?d.c.play(b):d.r.get()==="true"?(d.o.set(),b=d.d.order[0],b!==void 0&&d.c.play(b)):(d.o.set(),d.d.nP=-1)}},prev:function(){d.a.pause();if(h!==null&&d.r.get()==="one"&&h.duration){h.currentTime=0;d.a.play();var b=f("tr.ui-selected");b.size()<2&&(b.U(!0),f("tr.nP").S().L())}else{if(h!==null&&h.duration)h.currentTime=0,d.i.seek();b=d.d.order[d.d.nP-
1];b>=0?d.c.play(b):d.r.get()==="true"?(b=d.d.order[d.d.order.length-1],b!==void 0&&d.c.play(b)):(d.o.set(),d.d.nP=-1)}},toggle:function(){h!==null&&(h.paused?d.a.play():d.a.pause())},seekBy:function(b){if(h!==null&&d.d.nP>=0&&h.duration){var f=h.currentTime,e=h.duration;b<0&&f<-b?(h.currentTime=0,d.i.seek(),f<-b/4&&d.a.prev()):f+b>e?(h.currentTime=e,d.i.seek(),d.a.next()):h.currentTime+=b;d.i.seek()}}};d.o={set:function(){var b=d.sh.get();d.d.order=[];f("tr",e.tbody).each(function(){d.d.order.push(parseInt(f(this).attr("number"),
10))});b&&d.o.shuffle();d.d.nP=d.d.order.indexOf(parseInt(f("tr.nP").attr("number"),10))},shuffle:function(){d.d.order.shuffle()},sort:function(){var b=[];return function(j,g){j===void 0&&(j=1);var a=f("th:not(.splitter)").eq(j).text()==="track"?function(a){return parseInt(c(a),10)}:function(a){return a};b[1]=b[0]?j===b[0].i?b[1]:b[0]:{i:1,order:1,f:function(a){return a}};b[0]={i:j,order:g,f:a};e.tbody.html(f("tr",e.tbody).sort(function(){var a=b[1].order,d=j,f=b[1].i;return function(b,e){var j=b.childNodes[2*
d].innerText,h=e.childNodes[2*d].innerText,k=b.childNodes[2*f].innerText,o=e.childNodes[2*f].innerText;return j>h?g:j<h?-g:k>=o?a:-a}}()));d.ui.selectableSet();d.o.set()}}()};d.r=function(){var b="false",d=function(b){e.repeat.css({opacity:b==="false"?0.4:""}).attr({src:b==="one"?"./img/one.png":"./img/repeat.png"})};return{set:function(){b=k&&k.repeat?k.repeat.toString():"false";d(b)},toggle:function(){switch(b){case "true":b="one";break;case "one":b="false";break;default:b="true"}d(b);k.repeat=
b.toString()},get:function(){return b}}}();d.sh=function(){var b="false",f=function(b){e.shuffle.css({opacity:b.toString()==="true"?"":0.4})};return{set:function(){b=k&&k.shuffle?k.shuffle.toString():"false";f(b);d.o.set()},toggle:function(){b=(b!=="true").toString();f(b);k.shuffle=b.toString();d.o.set()},get:function(){return b==="true"}}}();d.i={seek:function(){var b=function(){var a=parseInt,b=isNaN;return function(d){d=a(d,10);if(b(d))return"00:00";var f=a(d/60%60,10),e=a(d/3600,10);d%=60;return e>
0?e.toString()+":"+(f<10?"0":"")+f.toString()+":"+(d<10?"0":"")+d.toString():(f<10?"0":"")+f.toString()+":"+(d<10?"0":"")+d.toString()}}(),d=document.getElementById("current"),f=document.getElementById("remain");return function(){var a=h.currentTime,i=h.duration;e.musicSlider.slider({value:a/i});d.innerText=b(a);f.innerText="-"+b(i-a)}}(),startSlide:function(){clearInterval(d.d.seek)},stopSlide:function(b,f){h.currentTime=h.duration*f.value;d.d.seek=setInterval(d.i.seek,500)},showFileName:function(b,
f){if(d.d.tags){var g=d.d.tags[f];if(g&&g.TIT2)document.title=(g.TIT2||"")+" - "+(g.TPE1||"")+","+(g.TALB||""),b=g.TPE1+" - "+g.TIT2}document.title=b;e.filename.texttitle(b)}};d.f=function(){var b=[],h=0,g=[];return{set:function(){b=[];h=0;g=f("ui-selected");e.filter.fadeIn(200);var a=e.filterword.focus()[0];a.selectionStart=0;a.selectionEnd=a.value.length;f("tr",e.tbody).each(function(a,e){b[a]=function(b){var d=[];for(a in b)d.push(b[a]);return d}(d.d.tags[f(e).attr("number")]).join("__").toLowerCase()});
e.matchnum.text("")},start:function(a){setTimeout(function(){if(a.keyCode!==13){var d=a.target.value.toLowerCase(),h=[],j=f("tr",e.tbody);f("tr.ui-selected",e.tbody).U(!0);if(d)try{b.forEach(function(a,b){a.match(d)!==null&&h.push(b)}),h.forEach(function(a){j.eq(a).S(!0)}),e.matchnum.text(h.length+"/"+j.length),g=f("tr.ui-selected")}catch(l){}else e.matchnum.text("0/"+j.length)}},20)},end:function(){e.filter.fadeOut(200);e.filterword.focusout();d.k.tab(0)},blink:function(){isNaN(h)&&(h=0);var a=g.eq(h).U(!0);
setTimeout(function(){a.S(!1,!0)},200);h=++h%g.size()}}}();d.c=function(){var b=[],j=function(a){switch(a.charCodeAt(0)){case 0:return a.toString();case 2:case 1:for(var b="",d=String.fromCharCode,f,e=1,g=a.length;e<g;)f===1||(a.charCodeAt(e)&255)===255?(f||(e+=2,f=1),b+=d(a.charCodeAt(e++)|a.charCodeAt(e++)<<8)):f===2||(a.charCodeAt(e)&254)===254?(f||(e+=2,f=2),b+=d(a.charCodeAt(e++)<<8|a.charCodeAt(e++))):b+=a[e++];return b;case 3:b="";d=String.fromCharCode;e=1;for(g=a.length;e<g;)f=a.charCodeAt(e),
b+=f&128?f&32?f&16?f&8?f&4?d((a.charCodeAt(e++)&1)<<30|(a.charCodeAt(e++)&63)<<24|(a.charCodeAt(e++)&63)<<18|(a.charCodeAt(e++)&63)<<12|a.charCodeAt(e++)&6|a.charCodeAt(e++)):d((a.charCodeAt(e++)&3)<<24|(a.charCodeAt(e++)&63)<<18|(a.charCodeAt(e++)&63)<<12|a.charCodeAt(e++)&6|a.charCodeAt(e++)):d((a.charCodeAt(e++)&7)<<18|(a.charCodeAt(e++)&63)<<12|a.charCodeAt(e++)&6|a.charCodeAt(e++)):d((a.charCodeAt(e++)&15)<<12|(a.charCodeAt(e++)&63)<<6|a.charCodeAt(e++)&63):d((a.charCodeAt(e++)&31)<<6|a.charCodeAt(e++)&
63):a[e++];return b}},g=function(){var a=function(a,b){var e=a.target.result,g=0,h=e.slice(g,g+=10),k=h.slice(5,6).toBin(),h=h.slice(6,10).unsynchsafe();k[1]==="1"&&(k=e.slice(g,g+=4).unsynchsafe(),e.slice(g,g+=k));for(var k={},r=parseInt;g<h;){var p=e.slice(g,g+=4),o=function(a){return r(a.charCodeAt(3),10)}(e.slice(g,g+=4));g+=2;var q=j(e.slice(g,g+=o));o&&q&&(k[p]=q)}if(!d.d.tags)d.d.tags=[];d.d.tags[b]=k;f("tr[number="+b+"]").find(".artist").texttitle(k.TPE1||"").end().find(".track").texttitle(k.TRCK||
"").end().find(".title").texttitle(k.TIT2||"").end().find(".album").texttitle(k.TALB||"")};return function(b,d){var e=new FileReader;e.onload=function(b){a(b,d)};try{e.readAsBinaryString(b.slice(0,1E3))}catch(f){e.readAsBinaryString(b.webkitSlice(0,1E3))}}}();return{readFiles:function(a){var g=e.tbody.width();f("tr",e.tbody).each(function(){f("<tr />").attr({number:f(this).attr("number")}).append(f(this).children()).dblclick(d.a.playThis).width(g).appendTo(e.tbody).addClass(f(this).hasClass("nP")?
"nP":"")}).remove();for(var j=d.c.tagread,k=/audio\/.*(mp3|ogg|m4a|mp4)/,l=[],n=-1,s=-1,r=a.length,p=b.length;++s<r;++p){var o=a[s],q=o.name;o.type.match(k)&&(l[++n]='<tr number="',l[++n]=p,l[++n]='" style="width:',l[++n]=g,l[++n]='px;">',l[++n]='<td class="now">',l[++n]="<td></td>",l[++n]='<td><div class="filename" title="',l[++n]=q,l[++n]='" >',l[++n]=q,l[++n]="</div></td>",l[++n]='<td></td><td><div class="artist"></div></td><td></td><td><div class="title"></div></td><td></td><td><div class="track"></div></td><td></td><td><div class="album"></div></td></tr>',
b[p]=o,j(p))}e.tbody[0].innerHTML+=l.join("");d.o.set();(h===null||d.d.nP<0&&h.paused)&&d.a.next();d.ui.selectableSet()},tagread:function(a){if(d.d.tagread!=="false"){var e=b[a];e&&g(e,a)}},play:function(a){var e=b[a];if(e){if(!d.d.tags||!d.d.tags[a])d.c.tagread(a),setTimeout(function(){d.i.showFileName(e.fileName,a)},1E3);var g=new FileReader;g.onload=function(a){h!==null&&(h.removeEventListener("ended",d.a.next),h=null);h=new Audio(a.target.result);d.v.set();d.a.play();h.addEventListener("ended",
d.a.next)};g.onerror=function(){d.a.next()};g.readAsDataURL(e);d.d.nP=d.d.order.indexOf(a);setTimeout(function(){d.i.showFileName(e.fileName,a)},100)}f("tr.nP").removeClass("nP").find("img").remove();f("tr[number="+a.toString()+"]").addClass("nP").find(".now").append('<img src="./img/now.png">');g=f("tr.ui-selected");g.size()<2&&(g.U(!0),f("tr.nP").S().L())}}}()})();