(function(k,d){function j(a){console.dir(a)}function h(a){console.log("--------------- "+a+" ---------------")}function C(a,b,c,e,f){a>b&&(a=b);this.min=a;this.max=b;this.step=c;this.initializer=e;this.callback=f||function(){}}function x(a){this.array=a}function y(a,b,c){this.enumclass=new x(a);this.array=this.enumclass.array;this.initializer=b;this.callback=c||function(){}}function w(a,b,c){this.enumclass=new x(a);this.array=this.enumclass.array;this.initializer=b;this.callback=c||function(){};var c=
c||function(){},e=this;this.enumlinear=new y(a,b,function(a){e.index=e.enumlinear.index;e.value=a;e.history=e.history.concat(e.value);e.array=e.enumlinear.array;c(a,e.app)});for(var f in this.enumlinear)this.enumlinear.hasOwnProperty(f)&&(this[f]=this.enumlinear[f])}function n(a,b,c){this.initializer=b;this.callback=c||function(){};var c=c||function(){},e=this;this.enumlinear=new y(a,function(){b();e.repeat.init();e.shuffle.init();e.enumlinear.init()},function(a,b){h("this.enumlinear callback");j("value: "+
a);e.index=e.enumlinear.index;e.value=a;e.history=e.history.concat(e.value);e.array=e.enumlinear.array;e.enumclass=e.enumlinear.enumclass;c(e.value,b)});this.repeat=new w(["false","true","one"],"false",function(a){j("repeat:"+a)});this.shuffle=new w(["false","true"],"false",function(a){j("shuffle:::"+a);j(e.repeat.value);if(!e.orderedarray)e.orderedarray=e.enumlinear.enumclass.array||e.array||e.enumlinear.array||[];switch(a){case "true":a=(void 0===e.value||0>e.array.indexOf(e.value)?[]:[e.value]).concat(e.orderedarray.shuffle().drop(e.value));
e.changeArray(a);break;default:e.changeArray(e.orderedarray),delete e.orderedarray}});for(var f in this.enumlinear)this.enumlinear.hasOwnProperty(f)&&(this[f]=this.enumlinear[f])}function E(a){this.result=a;this.i=0}function I(a,b,c){function e(a,b,c,e,i,o){var d=f();if(d){"undefined"===typeof o&&(o=!0);if(b)"undefined"!=typeof d.onload?d.onload=function(){"200"==d.status||"206"==d.status?(d.fileSize=i||d.getResponseHeader("Content-Length"),b(d)):c&&c();d=A}:d.onreadystatechange=function(){if(4==
d.readyState)"200"==d.status||"206"==d.status?(d.fileSize=i||d.getResponseHeader("Content-Length"),b(d)):c&&c(),d=A};d.open("GET",a,o);d.overrideMimeType&&d.overrideMimeType("text/plain; charset=x-user-defined");e&&d.setRequestHeader("Range","bytes="+e[0]+"-"+e[1]);d.setRequestHeader("If-Modified-Since","Sat, 1 Jan 1970 00:00:00 GMT");d.send(A)}else c&&c()}function f(){var a=A;k.XMLHttpRequest?a=new XMLHttpRequest:k.F&&(a=new ActiveXObject("Microsoft.XMLHTTP"));return a}function o(a,b){var c=f();
if(c){if(b)"undefined"!=typeof c.onload?c.onload=function(){"200"==c.status&&b(this);c=A}:c.onreadystatechange=function(){4==c.readyState&&("200"==c.status&&b(this),c=A)};c.open("HEAD",a,!0);c.send(A)}}function i(a,b){function f(a){var b=~~(a[0]/o)-d,a=~~(a[1]/o)+1+d;0>b&&(b=0);a>=blockTotal&&(a=blockTotal-1);return[b,a]}function i(f,d){for(;j[f[0]];)if(f[0]++,f[0]>f[1]){d&&d();return}for(;j[f[1]];)if(f[1]--,f[0]>f[1]){d&&d();return}var t=[f[0]*o,(f[1]+1)*o-1];e(a,function(a){parseInt(a.getResponseHeader("Content-Length"),
10)==b&&(f[0]=0,f[1]=blockTotal-1,t[0]=0,t[1]=b-1);for(var a={data:a.W||a.responseText,s:t[0]},c=f[0];c<=f[1];c++)j[c]=a;h+=t[1]-t[0]+1;d&&d()},c,t,g,!!d)}var o,d,g,h=0,k=new F("",0,b),j=[];o=o||2048;d="undefined"===typeof d?0:d;blockTotal=~~((b-1)/o)+1;for(var q in k)k.hasOwnProperty(q)&&"function"===typeof k[q]&&(this[q]=k[q]);this.a=function(a){var b;i(f([a,a]));b=j[~~(a/o)];if("string"==typeof b.data)return b.data.charCodeAt(a-b.s)&255;if("unknown"==typeof b.data)return IEBinary_getByteAt(b.data,
a-b.s)};this.N=function(){return h};this.f=function(a,b){i(f(a),b)}}(function(){o(a,function(c){c=parseInt(c.getResponseHeader("Content-Length"),10)||-1;b(new i(a,c))})})()}function F(a,b,c){var e=a,f=b||0,d=0;this.P=function(){return e};if("string"==typeof a)d=c||e.length,this.a=function(a){return e.charCodeAt(a+f)&255};else if("unknown"==typeof a)d=c||IEBinary_getLength(e),this.a=function(a){return IEBinary_getByteAt(e,a+f)};this.n=function(a,b){for(var c=Array(b),e=0;e<b;e++)c[e]=this.a(a+e);return c};
this.j=function(){return d};this.d=function(a,b){return 0!=(this.a(a)&1<<b)};this.Q=function(a){a=this.a(a);return 127<a?a-256:a};this.r=function(a,b){var c=b?(this.a(a)<<8)+this.a(a+1):(this.a(a+1)<<8)+this.a(a);0>c&&(c+=65536);return c};this.S=function(a,b){var c=this.r(a,b);return 32767<c?c-65536:c};this.h=function(a,b){var c=this.a(a),e=this.a(a+1),f=this.a(a+2),d=this.a(a+3),c=b?(((c<<8)+e<<8)+f<<8)+d:(((d<<8)+f<<8)+e<<8)+c;0>c&&(c+=4294967296);return c};this.R=function(a,b){var c=this.h(a,b);
return 2147483647<c?c-4294967296:c};this.q=function(a){var b=this.a(a),c=this.a(a+1),a=this.a(a+2),b=((b<<8)+c<<8)+a;0>b&&(b+=16777216);return b};this.c=function(a,b){for(var c=[],e=a,f=0;e<a+b;e++,f++)c[f]=String.fromCharCode(this.a(e));return c.join("")};this.e=function(a,b,c){a=this.n(a,b);switch(c.toLowerCase()){case "utf-16":case "utf-16le":case "utf-16be":var b=c,e,f=0,d=1,c=0;e=Math.min(e||a.length,a.length);254==a[0]&&255==a[1]?(b=!0,f=2):255==a[0]&&254==a[1]&&(b=!1,f=2);b&&(d=0,c=1);for(var b=
[],o=0;f<e;o++){var g=a[f+d],h=(g<<8)+a[f+c],f=f+2;if(0==h)break;else 216>g||224<=g?b[o]=String.fromCharCode(h):(g=(a[f+d]<<8)+a[f+c],f+=2,b[o]=String.fromCharCode(h,g))}a=new String(b.join(""));a.g=f;break;case "utf-8":e=0;f=Math.min(f||a.length,a.length);239==a[0]&&187==a[1]&&191==a[2]&&(e=3);d=[];for(c=0;e<f&&!(b=a[e++],0==b);c++)128>b?d[c]=String.fromCharCode(b):194<=b&&224>b?(o=a[e++],d[c]=String.fromCharCode(((b&31)<<6)+(o&63))):224<=b&&240>b?(o=a[e++],h=a[e++],d[c]=String.fromCharCode(((b&
255)<<12)+((o&63)<<6)+(h&63))):240<=b&&245>b&&(o=a[e++],h=a[e++],g=a[e++],b=((b&7)<<18)+((o&63)<<12)+((h&63)<<6)+(g&63)-65536,d[c]=String.fromCharCode((b>>10)+55296,(b&1023)+56320));a=new String(d.join(""));a.g=e;break;default:f=[];d=d||a.length;for(e=0;e<d;){c=a[e++];if(0==c)break;f[e-1]=String.fromCharCode(c)}a=new String(f.join(""));a.g=e}return a};this.M=function(a){return String.fromCharCode(this.a(a))};this.Z=function(){return k.btoa(e)};this.L=function(a){e=k.atob(a)};this.f=function(a,b){b()}}
function G(a,b){this.file=a;this.type=a.type;this.name=a.name;this.filetype=a.filetype;if("video"===a.filetype&&b)this.htmlElement=b}function H(a){if(a)for(var b in a)if(a.hasOwnProperty(b)&&a[b]){var c=this.parse(b);this.set(c,a[b]);this.keys.push(c)}this.keys=this.keys.sort()}function B(){this.ui=p}Array.prototype.clone=function(){return Array.apply(null,this)};Array.prototype.drop=function(a){for(var b=[],c=0;c<this.length;c++)this[c]!==a&&(b=b.concat([this[c]]));return b};Array.prototype.shuffle=
function(){for(var a=this.clone(),b=a.length,c,e,f=Math.random,d=Math.floor;b;)c=d(f()*b),e=a[--b],a[b]=a[c],a[c]=e;return a};Array.prototype.unique=function(){var a=[],b,c,e,f,d;for(b=-1,e=this.length;b<e;++b){for(c=-1,f=a.length,d=!0;c<f;++c)a[c]===this[b]&&(c=f+1,d=!1);d&&a.push(this[b])}return a};if("undefined"!==typeof d&&"undefined"!==typeof d.fn)d.fn.texttitle=function(a){return this.text(a).attr("title",a)},d.fn.unique=Array.prototype.unique,d.fn.join=Array.prototype.join;if("undefined"!==
typeof exports)exports.log=j,exports.logfn=h;var J={strarr:"abcdefghijklmnopqrstuvwxyz",randomstr:function(){for(var a=this.strarr.length,b="",c=0;10>c;c++)b+=this.strarr[Math.floor(Math.random()*a)];return b},createId:function(){return(new Date).getTime().toString()+this.randomstr()},send:function(a){chrome.extension.sendRequest(a)}};C.prototype={value:void 0,at:function(a){this.value=void 0===a||isNaN(a)?void 0===this.value?(this.min+this.max)/2:this.assert(this.value):this.assert(a);this.callback(this.value,
this.app);return this.value},assert:function(a){return Math.min(Math.max(a,this.min),this.max)},increase:function(a){if(void 0===a||isNaN(a))a=this.step;return this.at(this.value+a)},decrease:function(a){if(void 0===a||isNaN(a))a=this.step;return this.increase(-a)},init:function(a){this.app=a;"function"===typeof this.initializer?this.at(this.initializer()):this.at(this.initializer)},setToMin:function(){return this.at(this.min)},setToMax:function(){return this.at(this.max)}};if("undefined"!==typeof exports)exports.Limited=
C;x.prototype={array:[],succ:function(a){return this.toEnum(1+this.fromEnum(a))},pred:function(a){return this.toEnum(-1+this.fromEnum(a))},toEnum:function(a){if(this.array&&0<=a&&a<this.array.length)return this.array[a]},fromEnum:function(a){if(this.array)for(var b=0,c=this.array.length;b<c;b++)if(this.array[b]===a)return b},enumFrom:function(a){return!this.array?void 0:this.enumFromTo(a,this.array[this.array.length-1])},enumFromThen:function(a,b){if(this.array){for(var c=this.fromEnum(a),e=this.fromEnum(b),
f=[],d=c;0<=d&&d<this.array.length;d+=e-c)f=f.concat(this.array[d]);return f}},enumFromTo:function(a,b){return this.enumFromThenTo(a,this.succ(a),b)},enumFromThenTo:function(a,b,c){if(this.array){var a=this.fromEnum(a),b=this.fromEnum(b),c=this.fromEnum(c),b=b-a,e=[];if(0===b)e=e.concat(this.array[a]);else if(0<b)for(;a<=c&&a<this.array.length;a+=b)e=e.concat(this.array[a]);else for(;a>=c&&0<=a;a+=b)e=e.concat(this.array[a]);return e}}};if("undefined"!==typeof exports)exports.Enum=x;if("undefined"===
typeof k)x=require("./enum").Enum;y.prototype={index:0,value:void 0,history:[],head:function(){h("Enumlinear.prototype.head");return this.at(0)},last:function(){h("Enumlinear.prototype.last");return this.at(this.enumclass.array.length-1)},nonvalidIndex:function(a){return void 0===a||isNaN(a)||"number"!==typeof a},at:function(a){h("Enumlinear.prototype.at");if(this.nonvalidIndex(a))a=this.index;var b=this.enumclass.toEnum(a);if(!(void 0===b||0===this.array.length))return this.value=b,this.index=a,
this.array=this.enumclass.array,this.history=this.history.concat(this.value),this.callback(this.value,this.app),this.value},atfromEnum:function(a){h("Enumlinear.prototype.atfromEnum");console.log("atfromEnum value: "+a);a=this.enumclass.fromEnum(a);return void 0===a?void 0:this.at(a)},next:function(a){h("Enumlinear.prototype.next");this.nonvalidIndex(a)&&(a=1);return this.at(this.index+a)},prev:function(a){h("Enumlinear.prototype.prev");this.nonvalidIndex(a)&&(a=-1);return this.next(a)},init:function(a){h("Enumlinear.prototype.init");
this.app=a;var b;if("function"===typeof this.initializer)try{b=this.initializer()}catch(c){b=this.array[0]}else b=this.initializer;b=this.atfromEnum(b);if(void 0===b)return this.at(0)},concat:function(a){h("Enumlinear.prototype.concat");return this.changeArray(this.enumclass.array.concat(a))},splice:function(a,b){h("Enumlinear.prototype.splice");var c=this.enumclass.array;c.splice(a,b);return this.changeArray(c)},remove:function(a){h("Enumlinear.prototype.remove");console.log("removing : "+a);return this.splice(this.enumclass.fromEnum(a),
1)},changeArray:function(a){h("Enumlinear.prototype.changeArray");console.log(a);a=a.drop(void 0);this.enumclass=new x(a);this.array=this.enumclass.array;this.at(this.enumclass.fromEnum(this.value)||0);return this}};if("undefined"!==typeof exports)exports.Enumlinear=y;if("undefined"===typeof k)x=require("./enum").Enum,y=require("./enumlinear").Enumlinear;w.prototype=new y;w.prototype.at=function(a){if(this.nonvalidIndex(a))a=this.index;var b=this.array.length;return this.enumlinear.at((a%b+b)%b)};
w.prototype.changeArray=function(a){this.enumlinear.changeArray(a);this.array=this.enumlinear.array;this.enumclass=this.enumlinear.enumclass};if("undefined"!==typeof exports)exports.Enumcycle=w;if("undefined"===typeof k)require("./prelude"),x=require("./enum").Enum,y=require("./enumlinear").Enumlinear,w=require("./enumcycle").Enumcycle;n.prototype=new y;n.prototype.at=function(a){h("Enumdinamic.prototype.at");if(this.nonvalidIndex(a))a=this.index;j("this:::");return this.enumlinear.at(a)};n.prototype.next=
function(a){h("Enumdinamic.prototype.next");if(void 0===a||isNaN(a))a=1;a=void 0===this.index?0:this.index+a;switch(this.repeat.value){case "one":a=this.index;break;case "true":var b=this.enumclass.toEnum(a);if(void 0===b)switch(this.shuffle.value){case "true":this.shuffleOn(),a++;default:b=this.array.length,a=(a%b+b)%b}break;default:if(b=this.enumclass.toEnum(a),void 0===b)switch(this.shuffle.value){case "true":this.shuffleOn();default:return}}return this.at(a)};n.prototype.concat=function(a){h("Enumdinamic.prototype.concat");
var b=this.array||[];this.orderedarray=(this.orderedarray||this.array||[]).concat(a);this.changeArray(b.concat(a));"true"===this.shuffle.value&&this.shuffleOn()};n.prototype.remove=function(a){j(this);h("Enumdinamic.prototype.remove");if(this.orderedarray)this.orderedarray=this.orderedarray.drop(a);this.enumlinear.remove(a);j(this)};n.prototype.changeArray=function(a){h("Enumdinamic.prototype.changeArray");j(this.value);a=a.drop(void 0);this.enumlinear.changeArray(a);this.array=this.enumlinear.array;
j("this.array: "+this.array.join(","));j("this.value: "+this.value);this.enumclass=this.enumlinear.enumclass;this.atfromEnum(this.value);for(var b in this.enumlinear)this.enumlinear.hasOwnProperty(b)&&(this[b]=this.enumlinear[b]);return this};n.prototype.setRepeat=function(a){this.repeat.atfromEnum(a)};n.prototype.repeatOff=function(){this.setRepeat("false")};n.prototype.repeatOn=function(){this.setRepeat("true")};n.prototype.repeatOne=function(){this.setRepeat("one")};n.prototype.repeatToggle=function(){this.repeat.next()};
n.prototype.repeatToggleOnOff=function(){this.setRepeat("false"===this.repeat.value?"true":"false")};n.prototype.setShuffle=function(a){this.shuffle.atfromEnum(a)};n.prototype.shuffleOff=function(){this.setShuffle("false")};n.prototype.shuffleOn=function(){this.setShuffle("true")};n.prototype.shuffleToggle=function(){this.shuffle.next()};n.prototype.shuffleToggleOnOff=function(){this.setShuffle("false"===this.shuffle.value?"true":"false")};if("undefined"!==typeof exports)exports.Enumdinamic=n;String.prototype.toBin=
function(){for(var a=[],b=9,c=this;--b;)a.push(c&128),c<<=1;return a.join("")};String.prototype.unsynchsafe=function(){return(this.charCodeAt(0)&127)<<21|(this.charCodeAt(1)&127)<<14|(this.charCodeAt(2)&127)<<7|this.charCodeAt(3)&127};E.prototype={read:function(){this.header();this.extendedheader();this.frames();return this.tags},header:function(){this.header=this.result.slice(this.i,this.i+=10);this.headerid=this.header.slice(0,3);this.version=[this.header.charCodeAt(3),this.header.charCodeAt(4)];
this.flags=this.header.slice(5,6).toBin();this.tagsize=this.header.slice(6,10).unsynchsafe()},extendedheader:function(){"1"===this.flags[1]&&this.result.slice(this.i,this.i+=this.result.slice(this.i,this.i+=4).unsynchsafe())},readFrameSize:function(a){return 128*(128*(128*parseInt(a.charCodeAt(0),10)+parseInt(a.charCodeAt(1),10))+parseInt(a.charCodeAt(2),10))+parseInt(a.charCodeAt(3),10)},frames:function(){for(var a={},b=this.i;b<this.tagsize;){var c=this.result.slice(b,b+=4).toString(),e=this.readFrameSize(this.result.slice(b,
b+=4));this.result.slice(b,b+=2).toBin();var f;a:{f=this.result.slice(b,b+=e);switch(f.charCodeAt(0)){case 0:j("ISO-8859-1");for(var d="",i=0;i<f.length;)d+=String.fromCharCode(f.charCodeAt(i++)|f.charCodeAt(i++)<<8);i=/.{0,2}[\uff01\ufe00]./;f=i.test(d)?d.replace(i,""):f.toString();break a;case 2:j("UTF-16BE without BOM");case 1:j("UTF-16 with BOM");for(var d="",m=String.fromCharCode,u=void 0,i=1,t=f.length;i<t;)1===u||255===(f.charCodeAt(i)&255)?(u||(i+=2,u=1),d+=m(f.charCodeAt(i++)|f.charCodeAt(i++)<<
8)):2===u||254===(f.charCodeAt(i)&254)?(u||(i+=2,u=2),d+=m(f.charCodeAt(i++)<<8|f.charCodeAt(i++))):d+=f[i++];f=d;break a;case 3:j("UTF-8");d="";m=String.fromCharCode;i=1;for(t=f.length;i<t;)u=f.charCodeAt(i),d=u&128?u&32?u&16?u&8?u&4?d+m((f.charCodeAt(i++)&1)<<30|(f.charCodeAt(i++)&63)<<24|(f.charCodeAt(i++)&63)<<18|(f.charCodeAt(i++)&63)<<12|f.charCodeAt(i++)&6|f.charCodeAt(i++)):d+m((f.charCodeAt(i++)&3)<<24|(f.charCodeAt(i++)&63)<<18|(f.charCodeAt(i++)&63)<<12|f.charCodeAt(i++)&6|f.charCodeAt(i++)):
d+m((f.charCodeAt(i++)&7)<<18|(f.charCodeAt(i++)&63)<<12|f.charCodeAt(i++)&6|f.charCodeAt(i++)):d+m((f.charCodeAt(i++)&15)<<12|(f.charCodeAt(i++)&63)<<6|f.charCodeAt(i++)&63):d+m((f.charCodeAt(i++)&31)<<6|f.charCodeAt(i++)&63):d+f[i++];f=d;break a}f=void 0}e&&(j("flame id: "+c),j("flame size: "+e),"APIC"!==c&&j("flame text: "+f),f&&(a[c]=f,this.shortcuts[c]&&(a[this.shortcuts[c]]=f)))}this.tags=a},shortcuts:{TIT2:"title",TPE1:"artist",TALB:"album",TYER:"year",COMM:"comment",TRCK:"track",TCON:"genre",
APIC:"picture",USLT:"lyrics",APIC:"picture"}};if("undefined"!==typeof exports)exports._ID3=E;var A=null;document.write("<script type='text/vbscript'>\r\nFunction IEBinary_getByteAt(strBinary, iOffset)\r\n\tIEBinary_getByteAt = AscB(MidB(strBinary,iOffset+1,1))\r\nEnd Function\r\nFunction IEBinary_getLength(strBinary)\r\n\tIEBinary_getLength = LenB(strBinary)\r\nEnd Function\r\n<\/script>\r\n");(function(a){a.FileAPIReader=function(a){return function(c,e){var f=new FileReader;f.onload=function(a){e(new F(a.target.result))};
f.readAsBinaryString(a)}}})(this);(function(a){a.k={i:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",z:function(a){for(var c="",e,f,d,i,m,u,t=0;t<a.length;)e=a[t++],f=a[t++],d=a[t++],i=e>>2,e=(e&3)<<4|f>>4,m=(f&15)<<2|d>>6,u=d&63,isNaN(f)?m=u=64:isNaN(d)&&(u=64),c=c+Base64.i.charAt(i)+Base64.i.charAt(e)+Base64.i.charAt(m)+Base64.i.charAt(u);return c}};a.Base64=a.k;a.k.encodeBytes=a.k.z})(this);(function(a){var b=a.t={},c={},e=[0,7];b.C=function(a,b,d){d=d||{};(d.dataReader||I)(a,
function(m){m.f(e,function(){var e="ftypM4A"==m.c(4,7)?ID4:"ID3"==m.c(0,3)?ID3v2:ID3v1;e.o(m,function(){var t=d.tags,g=e.p(m,t),t=c[a]||{},h;for(h in g)g.hasOwnProperty(h)&&(t[h]=g[h]);c[a]=t;b&&b()})})})};b.A=function(a){if(!c[a])return A;var b={},e;for(e in c[a])c[a].hasOwnProperty(e)&&(b[e]=c[a][e]);return b};b.B=function(a,b){return!c[a]?A:c[a][b]};a.ID3=a.t;b.loadTags=b.C;b.getAllTags=b.A;b.getTag=b.B})(this);(function(a){var b=a.u={},c="Blues,Classic Rock,Country,Dance,Disco,Funk,Grunge,Hip-Hop,Jazz,Metal,New Age,Oldies,Other,Pop,R&B,Rap,Reggae,Rock,Techno,Industrial,Alternative,Ska,Death Metal,Pranks,Soundtrack,Euro-Techno,Ambient,Trip-Hop,Vocal,Jazz+Funk,Fusion,Trance,Classical,Instrumental,Acid,House,Game,Sound Clip,Gospel,Noise,AlternRock,Bass,Soul,Punk,Space,Meditative,Instrumental Pop,Instrumental Rock,Ethnic,Gothic,Darkwave,Techno-Industrial,Electronic,Pop-Folk,Eurodance,Dream,Southern Rock,Comedy,Cult,Gangsta,Top 40,Christian Rap,Pop/Funk,Jungle,Native American,Cabaret,New Wave,Psychadelic,Rave,Showtunes,Trailer,Lo-Fi,Tribal,Acid Punk,Acid Jazz,Polka,Retro,Musical,Rock & Roll,Hard Rock,Folk,Folk-Rock,National Folk,Swing,Fast Fusion,Bebob,Latin,Revival,Celtic,Bluegrass,Avantgarde,Gothic Rock,Progressive Rock,Psychedelic Rock,Symphonic Rock,Slow Rock,Big Band,Chorus,Easy Listening,Acoustic,Humour,Speech,Chanson,Opera,Chamber Music,Sonata,Symphony,Booty Bass,Primus,Porn Groove,Satire,Slow Jam,Club,Tango,Samba,Folklore,Ballad,Power Ballad,Rhythmic Soul,Freestyle,Duet,Punk Rock,Drum Solo,Acapella,Euro-House,Dance Hall".split(",");
b.o=function(a,b){var c=a.j();a.f([c-128-1,c],b)};b.p=function(a){var b=a.j()-128;if("TAG"==a.c(b,3)){var d=a.c(b+3,30).replace(/\0/g,""),i=a.c(b+33,30).replace(/\0/g,""),m=a.c(b+63,30).replace(/\0/g,""),u=a.c(b+93,4).replace(/\0/g,"");if(0==a.a(b+97+28))var g=a.c(b+97,28).replace(/\0/g,""),h=a.a(b+97+29);else g="",h=0;a=a.a(b+97+30);return{version:"1.1",title:d,artist:i,album:m,year:u,comment:g,track:h,genre:255>a?c[a]:""}}return{}};a.ID3v1=a.u})(this);(function(a){function b(a,b){var c=b.a(a),e=
b.a(a+1),f=b.a(a+2);return b.a(a+3)&127|(f&127)<<7|(e&127)<<14|(c&127)<<21}var c=a.G={};c.b={};c.frames={BUF:"Recommended buffer size",CNT:"Play counter",COM:"Comments",CRA:"Audio encryption",CRM:"Encrypted meta frame",ETC:"Event timing codes",EQU:"Equalization",GEO:"General encapsulated object",IPL:"Involved people list",LNK:"Linked information",MCI:"Music CD Identifier",MLL:"MPEG location lookup table",PIC:"Attached picture",POP:"Popularimeter",REV:"Reverb",RVA:"Relative volume adjustment",SLT:"Synchronized lyric/text",
STC:"Synced tempo codes",TAL:"Album/Movie/Show title",TBP:"BPM (Beats Per Minute)",TCM:"Composer",TCO:"Content type",TCR:"Copyright message",TDA:"Date",TDY:"Playlist delay",TEN:"Encoded by",TFT:"File type",TIM:"Time",TKE:"Initial key",TLA:"Language(s)",TLE:"Length",TMT:"Media type",TOA:"Original artist(s)/performer(s)",TOF:"Original filename",TOL:"Original Lyricist(s)/text writer(s)",TOR:"Original release year",TOT:"Original album/Movie/Show title",TP1:"Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",
TP2:"Band/Orchestra/Accompaniment",TP3:"Conductor/Performer refinement",TP4:"Interpreted, remixed, or otherwise modified by",TPA:"Part of a set",TPB:"Publisher",TRC:"ISRC (International Standard Recording Code)",TRD:"Recording dates",TRK:"Track number/Position in set",TSI:"Size",TSS:"Software/hardware and settings used for encoding",TT1:"Content group description",TT2:"Title/Songname/Content description",TT3:"Subtitle/Description refinement",TXT:"Lyricist/text writer",TXX:"User defined text information frame",
TYE:"Year",UFI:"Unique file identifier",ULT:"Unsychronized lyric/text transcription",WAF:"Official audio file webpage",WAR:"Official artist/performer webpage",WAS:"Official audio source webpage",WCM:"Commercial information",WCP:"Copyright/Legal information",WPB:"Publishers official webpage",WXX:"User defined URL link frame",AENC:"Audio encryption",APIC:"Attached picture",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",
GRID:"Group identification registration",IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVAD:"Relative volume adjustment",RVRB:"Reverb",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",TCON:"Content type",
TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMED:"Media type",TOAL:"Original album/movie/show title",TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",
TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TYER:"Year",TXXX:"User defined text information frame",
UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"};var e={title:["TIT2","TT2"],artist:["TPE1","TP1"],album:["TALB","TAL"],year:["TYER","TYE"],comment:["COMM",
"COM"],track:["TRCK","TRK"],genre:["TCON","TCO"],picture:["APIC","PIC"],lyrics:["USLT","ULT"]},f=["title","artist","album","track"];c.o=function(a,c){a.f([0,b(6,a)],c)};c.p=function(a,d){var m=0,g=a.a(m+3);if(4<g)return{version:">2.4"};var h=a.a(m+4),k=a.d(m+5,7),j=a.d(m+5,6),l=a.d(m+5,5),n=b(m+6,a),m=m+10;if(j)var s=a.h(m,!0),m=m+(s+4);var g={version:"2."+g+"."+h,major:g,revision:h,flags:{unsynchronisation:k,extended_header:j,experimental_indicator:l},size:n},r;if(k)r={};else{for(var n=n-10,k=a,
h=d,j={},l=g.major,s=[],v=0,q;q=(h||f)[v];v++)s=s.concat(e[q]||[q]);for(h=s;m<n;){s=A;v=k;q=m;var p=A;switch(l){case 2:r=v.c(q,3);var z=v.q(q+3),w=6;break;case 3:r=v.c(q,4);z=v.h(q+4,!0);w=10;break;case 4:r=v.c(q,4),z=b(q+4,v),w=10}if(""==r)break;m+=w+z;if(!(0>h.indexOf(r))&&(2<l&&(p={message:{Y:v.d(q+8,6),K:v.d(q+8,5),V:v.d(q+8,4)},m:{T:v.d(q+8+1,7),H:v.d(q+8+1,3),J:v.d(q+8+1,2),D:v.d(q+8+1,1),w:v.d(q+8+1,0)}}),q+=w,p&&p.m.w&&(b(q,v),q+=4,z-=4),!p||!p.m.D))r in c.b?s=c.b[r]:"T"==r[0]&&(s=c.b["T*"]),
s=s?s(q,z,v,p):void 0,s={id:r,size:z,description:r in c.frames?c.frames[r]:"Unknown",data:s},r in j?(j[r].id&&(j[r]=[j[r]]),j[r].push(s)):j[r]=s}r=j}for(var x in e)if(e.hasOwnProperty(x)){a:{z=e[x];"string"==typeof z&&(z=[z]);for(w=0;m=z[w];w++)if(m in r){a=r[m].data;break a}a=void 0}a&&(g[x]=a)}for(var y in r)r.hasOwnProperty(y)&&(g[y]=r[y]);return g};a.ID3v2=c})(this);(function(){function a(a){var b;switch(a){case 0:b="iso-8859-1";break;case 1:b="utf-16";break;case 2:b="utf-16be";break;case 3:b=
"utf-8"}return b}var b="32x32 pixels 'file icon' (PNG only),Other file icon,Cover (front),Cover (back),Leaflet page,Media (e.g. lable side of CD),Lead artist/lead performer/soloist,Artist/performer,Conductor,Band/Orchestra,Composer,Lyricist/text writer,Recording Location,During recording,During performance,Movie/video screen capture,A bright coloured fish,Illustration,Band/artist logotype,Publisher/Studio logotype".split(",");ID3v2.b.APIC=function(c,e,f,d,i){var i=i||"3",d=c,g=a(f.a(c));switch(i){case "2":var h=
f.c(c+1,3),c=c+4;break;case "3":case "4":h=f.e(c+1,e-(c-d),g),c+=1+h.g}i=f.a(c,1);i=b[i];g=f.e(c+1,e-(c-d),g);c+=1+g.g;return{format:h.toString(),type:i,description:g.toString(),data:f.n(c,d+e-c)}};ID3v2.b.COMM=function(b,e,d){var o=b,i=a(d.a(b)),g=d.c(b+1,3),h=d.e(b+4,e-4,i),b=b+(4+h.g),b=d.e(b,o+e-b,i);return{language:g,X:h.toString(),text:b.toString()}};ID3v2.b.COM=ID3v2.b.COMM;ID3v2.b.PIC=function(a,b,d,o){return ID3v2.b.APIC(a,b,d,o,"2")};ID3v2.b.PCNT=function(a,b,d){return d.O(a)};ID3v2.b.CNT=
ID3v2.b.PCNT;ID3v2.b["T*"]=function(b,e,d){var o=a(d.a(b));return d.e(b+1,e-1,o).toString()};ID3v2.b.TCON=function(){return ID3v2.b["T*"].apply(this,arguments).replace(/^\(\d+\)/,"")};ID3v2.b.TCO=ID3v2.b.TCON;ID3v2.b.USLT=function(b,e,d){var o=b,i=a(d.a(b)),g=d.c(b+1,3),h=d.e(b+4,e-4,i),b=b+(4+h.g),b=d.e(b,o+e-b,i);return{language:g,I:h.toString(),U:b.toString()}};ID3v2.b.ULT=ID3v2.b.USLT})();(function(a){function b(a,c,d,g){var h=a.h(c,!0);if(0==h)g();else{var j=a.c(c+4,4);-1<["moov","udta","meta",
"ilst"].indexOf(j)?("meta"==j&&(c+=4),a.f([c+8,c+8+8],function(){b(a,c+8,h-8,g)})):a.f([c+(j in e.l?0:h),c+h+8],function(){b(a,c+h,d,g)})}}function c(a,b,d,g,h){for(var h=void 0===h?"":h+"  ",j=d;j<d+g;){var k=b.h(j,!0);if(0==k)break;var l=b.c(j+4,4);if(-1<["moov","udta","meta","ilst"].indexOf(l)){"meta"==l&&(j+=4);c(a,b,j+8,k-8,h);break}if(e.l[l]){var n=b.q(j+16+1),p=e.l[l],n=e.types[n];if("trkn"==l)a[p[0]]=b.a(j+16+11),a.count=b.a(j+16+13);else{var l=j+16+4+4,s=k-16-4-4;switch(n){case "text":a[p[0]]=
b.e(l,s,"UTF-8");break;case "uint8":a[p[0]]=b.r(l);break;case "jpeg":case "png":a[p[0]]={m:"image/"+n,data:b.n(l,s)}}}}j+=k}}var e=a.v={};e.types={"0":"uint8",1:"text",13:"jpeg",14:"png",21:"uint8"};e.l={"\u00a9alb":["album"],"\u00a9art":["artist"],"\u00a9ART":["artist"],aART:["artist"],"\u00a9day":["year"],"\u00a9nam":["title"],"\u00a9gen":["genre"],trkn:["track"],"\u00a9wrt":["composer"],"\u00a9too":["encoder"],cprt:["copyright"],covr:["picture"],"\u00a9grp":["grouping"],keyw:["keyword"],"\u00a9lyr":["lyrics"],
"\u00a9gen":["genre"]};e.o=function(a,c){a.f([0,7],function(){b(a,0,a.j(),c)})};e.p=function(a){var b={};c(b,a,0,a.j());return b};a.ID4=a.v})(this);G.prototype={toString:function(){return JSON.stringify({type:this.type,name:this.name,filetype:this.filetype,src:this.audio.src})},musicread:function(a,b,c){var e=this,d=k.URL&&k.URL.createObjectURL?function(a){return k.URL.createObjectURL(a)}:k.webkitURL&&k.webkitURL.createObjectURL?function(a){return k.webkitURL.createObjectURL(a)}:void 0;if(d)if("audio"===
e.file.filetype){e.audio=new Audio(e.url=d(e.file));if(e.htmlElement)e.htmlElement.src=e.audio.src;e.audio.volume=a;e.audio.addEventListener("ended",function(){e.release();b()});c&&e.audio.play()}else{if("video"===e.file.filetype){d=d(e.file);if(e.htmlElement)e.htmlElement.src=e.url=d;e.audio=e.htmlElement;e.audio.volume=a;e.audio.addEventListener("ended",function(){e.release();b()});c&&e.audio.play()}}else"audio"===e.file.filetype?(d=new FileReader,d.onerror=function(a){j(a)},d.onload=function(d){e.audio=
new Audio(d.target.result);if(e.htmlElement)e.htmlElement.src=e.audio.src;e.audio.volume=a;e.audio.addEventListener("ended",function(){e.release();b()});c&&e.audio.play()},d.readAsDataURL(e.file)):b()},ontagload:function(a,b){this.tags=(new E(a.target.result)).read();this.tags.type=this.type;this.tags.name=this.name;b(this.tags)},mytagreader:function(a){var b=this,c=new FileReader;c.onload=function(c){b.ontagload(c,a)};c.readAsBinaryString(this.file.webkitSlice(0,2E5))},tagread:function(a){this.mytagreader(a)},
readpicture:function(){var a=this,b=webkitURL.createObjectURL(this.file);try{ID3.loadTags(b,function(){var c=ID3.getAllTags(b);if(c&&c.picture)a.tags.picture=c.picture},{tags:["picture"],dataReader:FileAPIReader(this.file)})}catch(c){console.dir(c)}},play:function(a,b){var c=this;c.audio?(c.audio.volume=a,c.audio.addEventListener("ended",function(){c.release();b()}),c.audio.play()):c.musicread(a,b,!0)},pause:function(){this.audio&&this.audio.pause()},resume:function(){this.audio&&this.audio.play()},
paused:function(){return!this.audio||this.audio.paused},setvolume:function(a){if(this.audio)this.audio.volume=a},mute:function(){this.predvol=this.audio.volume;this.setvolume(0)},release:function(){this.audio&&delete this.audio},seekBy:function(a){if(this.audio){var b=this.audio.currentTime,c=this.audio.duration;if(0>a&&b<-a){if(this.audio.currentTime=0,b<-a/4)return!0}else this.audio.currentTime=b+a>c?c:this.audio.currentTime+a}}};var l={get:function(a){return localStorage.getItem(a)},set:function(a,
b){localStorage.setItem(a,b)},remove:function(a){localStorage.removeItem(a)},clear:function(){localStorage.clear()},getSetting:function(a){return l.get("store.settings."+a)},getSettingParse:function(a){return JSON.parse(l.get("store.settings."+a))}},D={"classic-default":{"background-color":{"div#wrapper":"#aaa","div#info":"#eee","div#playlist":"#fff","thead tr":"#ddd","div#musicSlider":"#aaa","div#musicSlider a":"#666","div#musicSlider a:focus":"#333","div#volumeSlider":"#eee","tbody tr:nth-child(odd) ":"#fff",
"tbody tr:nth-child(even) ":"#ddf","tbody tr.nP":"#aaf","tbody tr.ui-selected":"#08f"},color:{"tbody tr.ui-selected":"#fff"}},"classic-pink":{"background-color":{"div#wrapper":"#f66","div#info":"#fbb","thead tr":"#f99","div#musicSlider":"#f66","div#musicSlider a":"#844","div#musicSlider a:focus":"#622","div#volumeSlider":"#f88","tbody tr:nth-child(odd) ":"#fdd","tbody tr:nth-child(even) ":"#fbb","tbody tr.nP":"#f77","div#playlist":"#fdd","tbody tr.ui-selected":"#f22"},color:{"tbody tr.ui-selected":"#fff"}},
"classic-yellow":{"background-color":{"div#wrapper":"#ff0","div#info":"#ff8","thead tr":"#ff8","div#musicSlider":"#ff0","div#musicSlider a":"#880","div#musicSlider a:focus":"#640","div#volumeSlider":"#ff8","tbody tr:nth-child(odd) ":"#ff7","tbody tr:nth-child(even) ":"#ff6","tbody tr.nP":"#ff4","div#playlist":"#ffb","tbody tr.ui-selected":"#ff0"},color:{"tbody tr.ui-selected":"#000!important"}},"classic-orange":{"background-color":{"div#wrapper":"#f80","div#info":"#fb8","thead tr":"#fb8","div#musicSlider":"#f80",
"div#musicSlider a":"#840","div#musicSlider a:focus":"#620","div#volumeSlider":"#fb8","tbody tr:nth-child(odd) ":"#ff8","tbody tr:nth-child(even) ":"#fd6","tbody tr.nP":"#fa0","div#playlist":"#fdb","tbody tr.ui-selected":"#f60"},color:{"tbody tr.ui-selected":"#000"}},"classic-lime":{"background-color":{"div#wrapper":"#6f6","div#info":"#bfb","div#playlist":"#fff","thead tr":"#9f9","div#musicSlider":"#6f6","div#musicSlider a":"#484","div#musicSlider a:focus":"#262","div#volumeSlider":"#8f8","tbody tr:nth-child(odd) ":"#dfd",
"tbody tr:nth-child(even) ":"#bfb","tbody tr.nP":"#7f7","div#playlist":"#dfd","tbody tr.ui-selected":"#2f2"},color:{"tbody tr.ui-selected":"#fff"}},"classic-blue":{"background-color":{"div#wrapper":"#66f","div#info":"#bbf","thead tr":"#99f","div#musicSlider":"#66f","div#musicSlider a":"#448","div#musicSlider a:focus":"#226","div#volumeSlider":"#88f","tbody tr:nth-child(odd) ":"#ddf","tbody tr:nth-child(even) ":"#bbf","tbody tr.nP":"#77f","div#playlist":"#ddf","tbody tr.ui-selected":"#22f"},color:{"tbody tr.ui-selected":"#fff"}},
"classic-purple":{"background-color":{"div#wrapper":"#f0f","div#info":"#f8f","thead tr":"#f8f","div#musicSlider":"#f0f","div#musicSlider a":"#808","div#musicSlider a:focus":"#604","div#volumeSlider":"#f8f","tbody tr:nth-child(odd) ":"#f7f","tbody tr:nth-child(even) ":"#f6f","tbody tr.nP":"#f4f","div#playlist":"#fbf","tbody tr.ui-selected":"#f0f"},color:{"tbody tr.ui-selected":"#000"}},"classic-dark":{"background-color":{"div#wrapper":"#000","div#info":"#333","thead tr":"#333","div#musicSlider":"#000",
"div#musicSlider a":"#666","div#musicSlider a:focus":"#999","div#volumeSlider":"#333","div#volumeSlider a":"#666","div#volumeSlider a:focus":"#666","tbody tr:nth-child(odd) ":"#222","tbody tr:nth-child(even) ":"#292929","tbody tr.nP":"#444","div#playlist":"#111","tbody tr.ui-selected":"#080808"},color:{"div#wrapper":"#fff"}}},p={init:function(a){var b=this;b.player=a;b.div=function(a,b){a.forEach(function(a){b[a]=d("#"+a)});return b}("about,conf,config,current,filename,fileselect,firstrow,globalcontrol,help,musicSlider,mute,next,open,pause,play,playlist,prev,property,remain,repeat,scheme,shuffle,tablebody,tablediv,tagread,volumeSlider,volumeon,wrapper,filter,filterword,matchnum,notification,notificationmsec,notificationresult,info,infowrapper,albumart,seek".split(","),
{tbody:d("#tbody"),thead:d("thead"),table:d("table"),video:document.getElementsByTagName("video")[0]});b.initdrop();b.initbuttons();b.colorset();b.initsize();b.initslider();b.selectableSet();b.initFilter();b.initsplitter();b.resizableSet();b.initClickEscape();b.fullScreenOff();d(k).resize(function(){b.initsize()});d("div#appname a").text("Local Player ver "+a.version).click(function(){b.toggleAbout()})},initdrop:function(){var a=this;document.body.ondragover=function(a){a.preventDefault()};document.body.ondrop=
function(b){b.stopPropagation();b.preventDefault();b.dataTransfer&&b.dataTransfer.files&&a.player.readFiles(b.dataTransfer.files)}},initbuttons:function(){function a(a){a=parseInt(parseInt(a,10)/1E3,10);return(10>a?"&nbsp;"+a:a)+"sec"}var b=this,c=b.player;b.div.open.click(function(){b.div.fileselect.click()});b.div.fileselect.change(function(a){c.readFiles(a.target.files)});b.div.play.click(function(){c.toggle()});b.div.pause.click(function(){c.toggle()});b.div.prev.click(function(){c.prev()});b.div.next.click(function(){c.next()});
b.div.mute.click(function(){c.mute()});b.div.volumeon.click(function(){c.resume()});b.div.repeat.click(function(){c.repeat.next()});b.div.shuffle.click(function(){c.shuffle.next()});b.div.conf.click(function(){k.open("./fancy-settings/source/index.html")});d("img.lbutton, img.rbutton").mouseup(function(){d(this).css({top:"50%"})}).mousedown(function(){d(this).css({top:1.03*parseInt(d(this).css("top"),10)+"%"})});b.div.filename.click(function(){b.selectNowplaying()});b.div.tablebody.click(function(){b.focusIndex=
0;b.focusUpdate(!0)});b.div.globalcontrol.attr({checked:"true"===l.getSetting("globalcontrol")}).change(function(a){l.set("globalcontrol",a.target.checked.toString())});b.div.notification.attr({checked:"true"===(l.getSetting("notification")||"true")}).change(function(a){l.set("notification",a.target.checked.toString());void 0===l.getSetting("notificationmsec")&&l.set("notificationmsec",b.div.notificationmsec.valueAsNumber)});l.set("notification","checked"===b.div.notification.attr("checked"));b.div.notificationmsec.attr({value:parseInt(l.getSetting("notificationmsec"),
10)||5E3}).change(function(c){l.set("notificationmsec",c.target.valueAsNumber);b.div.notificationresult.html(a(c.target.valueAsNumber))});b.div.notificationresult.html(a(b.div.notificationmsec.attr("value")))},initsize:function(){var a=this.div.tbody.width(),b=12*(k.innerWidth-1280)/2360+12;this.div.wrapper.css({"font-size":b});this.div.playlist.height(k.innerHeight-this.div.playlist.offset().top-b);this.div.tablediv.height(k.innerHeight-this.div.tablediv.offset().top-b);this.div.tablebody.height(k.innerHeight-
this.div.tablebody.offset().top-b);d("tr").css({width:a})},initsplitter:function(){var a;a=void 0===l.get("splitter")?{now:0.05,filename:0.1,artist:0.2,title:0.3,track:0.05,album:0.25}:JSON.parse(l.get("splitter"));for(var b in a)d("th."+b).width(a[b]*this.div.thead.width())},initschemes:function(){var a=l.getSettingParse("scheme")||"classic-default",b=this,c;for(c in D)d("<a />").attr("scheme",c).css({color:D[c].color["div#wrapper"]||"black","background-color":D[c]["background-color"]["div#wrapper"]}).addClass(a===
c?"currentScheme":"").click(function(){b.setscheme(d(this).attr("scheme"))}).appendTo(this.div.scheme)},initslider:function(){var a=this;this.div.volumeSlider.slider({min:0,max:256,step:8,value:a.player.volume.value,slide:function(){a.player.updatevolume()},stop:function(){a.player.updatevolume()}});this.div.musicSlider.slider({min:0,max:1,step:0.01,start:function(b,c){a.startSlide(b,c)},stop:function(b,c){a.stopSlide(b,c)}}).slider("disable")},initClickEscape:function(){var a=this;a.div.help.click(function(){a.div.help.fadeOut(200);
a.focusIndex=0;a.focusUpdate(!0)});a.div.config.click(function(b){if(0>["a","input","textarea"].indexOf(b.target.localName))a.div.config.fadeOut(200),a.focusIndex=0,a.focusUpdate(!0)});a.div.about.click(function(b){if("a"!==b.target.localName)a.div.about.fadeOut(200),a.focusIndex=0,a.focusUpdate(!0)});a.div.property.click(function(b){if("a"!==b.target.localName)a.div.property.fadeOut(200),a.focusIndex=0,a.focusUpdate(!0)});setTimeout(function(){a.div.thead.find("th").each(function(b){d(this).click(function(b){var d=
1;return function(){a.sortorder(b,d);d*=-1}}(b))})},100)},setorder_identity:function(a){return a},setorder_replace_num:function(a){return parseInt(a.replace(/\uff11/,"1").replace(/\uff12/,"2").replace(/\uff13/,"3").replace(/\uff14/,"4").replace(/\uff15/,"5").replace(/\uff16/,"6").replace(/\uff17/,"7").replace(/\uff18/,"8").replace(/\uff19/,"9").replace(/\uff10/,"0").replace(/[\0-\46]/g,"").replace(/\/.*/,""),10)},sortorder:function(){var a=[];return function(b,c){void 0===b&&(b=1);var e="track"===
d("th").eq(b).text()?this.setorder_replace_num:this.setorder_identity;a[1]=a[0]?b===a[0].i?a[1]:a[0]:{i:1,order:1,f:this.setorder_identity};a[0]={i:b,order:c,f:e};this.div.tbody.html(d("tr",this.div.tbody).sort(function(){var d=a[1].order,h=b,i=a[1].i,g=[],j=[];return function(b,k){var l=b.getAttribute("number"),n=k.getAttribute("number"),p=g[l]||(g[l]=b.childNodes[h].innerText),s=g[n]||(g[n]=k.childNodes[h].innerText),l=j[l]||(j[l]=b.childNodes[i].innerText),n=j[n]||(j[n]=k.childNodes[i].innerText);
return e(p)>e(s)?c:e(p)<e(s)?-c:a[1].f(l)>=a[1].f(n)?d:-d}}()));this.selectableSet();this.setorder()}}(),setorder:function(){var a=[];d("tr",this.div.tbody).each(function(){a.push(parseInt(d(this).attr("number"),10))});this.player.order.changeArray(a);"true"===this.player.shuffle.value&&this.player.order.shuffleOn()},startSlide:function(){this.seeking&&clearInterval(this.seeking)},stopSlide:function(a,b){var c=this;if(c.player.seekAt(b.value))c.seeking=setInterval(function(){c.seek()},1E3)},addfile:function(a,
b){var c=[],d=-1,f=this.div.tbody.width();c[++d]='<tr class="music" number="';c[++d]=b;c[++d]='" style="width:';c[++d]=f;c[++d]='px;">';c[++d]='<td class="now">';c[++d]="<td></td>";c[++d]='<td><div class="filename" title="';c[++d]=a.name;c[++d]='" >';c[++d]=a.name;c[++d]="</div></td>";c[++d]='<td></td><td><div class="artist"></div></td><td></td><td><div class="title"></div></td><td></td><td><div class="track"></div></td><td></td><td><div class="album"></div></td></tr>';this.div.tbody[0].innerHTML+=
c.join("")},ontagread:function(a,b){d("tr[number="+b+"]").find(".artist").texttitle(a.artist||"").end().find(".track").texttitle(a.track||"").end().find(".title").texttitle(a.title||"").end().find(".album").texttitle(a.album||"")},setdblclick:function(){var a=this;d("tr.music").dblclick(function(b){a.div.musicSlider.slider({value:0});b=parseInt(d(b.target).closest("tr").attr("number")||b.closest("tr").attr("number")||b.attr("number"),10);a.player.pause();a.player.play(b)})},getvolume:function(){return parseInt(this.div.volumeSlider.slider("value"),
10)},setvolume:function(a){this.div&&this.div.volumeSlider&&this.div.volumeSlider.slider({value:a})},popupvideo:function(){this.div.video.parentNode.style.visibility="visible"},hidevideo:function(){this.div.video.parentNode.style.visibility="hidden"},showAlbumArt:function(a){var b=d("img#art")[0];if(a.tags&&a.tags.picture)try{var c=a.tags.picture;b.src="data:"+c.format+";base64,"+Base64.encodeBytes(c.data);this.div.albumart.addClass("realart")}catch(e){j(e)}else b.src="./icon_128.png",this.div.albumart.removeClass("realart")},
play:function(a){var b=this;b.div.musicSlider.slider("enable");var c=b.player.playing;this.fullScreen&&this.fullScreenOn();b.showFileName(c.name,a);d("tr.nP").removeClass("nP").find("img").remove();d("tr[number="+a.toString()+"]").addClass("nP").find(".now").append('<img src="./img/now.png">');a=d("tr.ui-selected");2>a.size()&&(a.UNSELECT(!0),d("tr.nP").SELECT().LASTSELECT());b.seeking&&clearInterval(b.seeking);b.seeking=setInterval(function(){b.seek()},1E3);setTimeout(function(){b.reflesh()},50);
setTimeout(function(){b.reflesh()},500);try{b.showAlbumArt(c),setTimeout(function(){b.showAlbumArt(c)},200)}catch(e){}},pause:function(){var a=this;this.seeking&&clearInterval(this.seeking);this.reflesh(!1);setTimeout(function(){a.reflesh()},50)},reflesh:function(a){this.div.play.attr(!1===a||void 0!==this.player.playing&&this.player.playing.paused()?{src:"./img/play.png",title:"Play"}:{src:"./img/pause.png",title:"Pause"})},seek:function(){var a=function(a){a=parseInt(a,10);if(isNaN(a))return"00:00";
var c=parseInt(a/60%60,10),d=parseInt(a/3600,10),a=a%60;return 0<d?d.toString()+":"+(10>c?"0":"")+c.toString()+":"+(10>a?"0":"")+a.toString():(10>c?"0":"")+c.toString()+":"+(10>a?"0":"")+a.toString()};return function(){if(void 0!=this.player.playing&&this.player.playing.audio){var b=this.player.playing.audio.currentTime,c=this.player.playing.audio.duration;this.div.musicSlider.slider({value:b/c});this.div.current.text(a(b));this.div.remain.text("-"+a(c-b))}}}(),colorset:function(){var a=l.getSettingParse("scheme")||
"classic-default",b=D[a];d("a.currentScheme").removeClass("currentScheme");d("a[scheme="+a+"]").addClass("currentScheme");var a=[],c;for(c in b)for(var e in b[c])a.push(e+" { "+c+":"+b[c][e]+";}");d("style#sch").text(a.join("\n")).size()||d("<style />",{id:"sch"}).text(a.join("\n")).appendTo(d("head"))},setscheme:function(a){l.set("scheme",a);this.colorset()},resizableSet:function(){var a=this;d("th:not(.splitter)+th:not(.splitter)",this.div.thead).each(function(){var b=!1,c=d("<th />",{"class":"splitter"}).mousedown(function(){b=
!0}).insertBefore(d(this));d(k).mouseup(function(){b&&(b=!1,a.afterResize())}).mousemove(function(a){if(b){var d=c.prev().width()+c.next().width();c.prev().width(a=-c.prev().offset().left+a.clientX);c.next().width(d-a)}})})},afterResize:function(){var a=[],b={},c=this.div.thead.width();d("th:not(.splitter)").each(function(e){var f=d(this).width()/(c-0);a.push("td:nth-child("+(e+1)+") {width:"+100*f+"%!important;}");b[d(this).attr("class")]=f});l.set("splitter",JSON.stringify(b));this.selectableSet()},
selectableSet:function(){var a=this,b=a.div.tbody.width();d("tr",a.div.tbody).each(function(){var c=d(this),e=d("<tr />").attr({number:c.attr("number")}).append(c.children()).click(function(b){var c=d("tr.last-select");a.focusIndex=0;a.focusUpdate(!0);if(b.shiftKey&&!b.altKey&&c.size()){if(b.ctrlKey){var e=d("tr.ui-selected");setTimeout(function(){e.SELECT(!0)},20)}b.clientY<c.position().top?setTimeout(function(){c.SELECT(!0).LASTSELECT().prevAll().filter(function(){return d(this).position().top>
b.clientY}).SELECT(!0)},20):setTimeout(function(){c.SELECT(!0).LASTSELECT().nextAll().filter(function(){return d(this).position().top<b.clientY}).SELECT(!0)},20)}}).dblclick(function(b){b=parseInt(d(b.target).closest("tr").attr("number")||b.closest("tr").attr("number")||b.attr("number"),10);a.player.pause();a.player.play(b)}).width(b).addClass(c.hasClass("nP")?"nP":"").addClass(c.hasClass("moved")?"ui-selected moved":"").addClass(c.hasClass("ui-selected")?"ui-selected":"").appendTo(a.div.tbody);c.ISSELECTED()&&
setTimeout(function(){e.SELECT(!0)},30)}).remove();d.fn.drag_drop_multi_select.unique=0;d.fn.drag_drop_multi_select.stack=[];d.fn.drag_drop_multi_select.settings=[];this.div.tbody.drag_drop_multi_select({element_to_drag_drop_select:"tr, this.div.tbody",elements_to_drop:this.div.tbody,moveOpacity:0.7})},setrepeat:function(a){this.div&&this.div.repeat&&this.div.repeat.css({opacity:"false"===a?0.4:""}).attr({src:"one"===a?"./img/one.png":"./img/repeat.png"})},setshuffle:function(a){this.div&&this.div.shuffle&&
this.div.shuffle.css({opacity:"true"===a.toString()?"":0.4})},prevNotification:null,showNotification:function(a,b,c){J.send({type:"notification",from:"player",icon:a,title:b,message:c})},formatTags:function(a){return a&&a.TPE1&&a.TIT2?a.TPE1+" - "+a.TIT2:""},showFileName:function(a,b,c){var d=this,f=this.player.musics[b].tags,a=d.formatTags(f)||a;document.title=a;this.div.filename.texttitle(a);if(f&&f.picture||c){var g=f&&f.picture?f.picture:void 0;try{var i=g?"data:"+g.format+";base64,"+Base64.encodeBytes(g.data):
"../icon_128.png"}catch(h){i="../icon_128.png"}""===d.formatTags(f)||!f.picture?c?f.artist&&f.title&&f.album?d.showNotification(i,f.artist,f.title+"  /  "+f.album):d.showNotification(i,a,""):setTimeout(function(){d.showFileName(a,b,!0)},200):d.showNotification(i,f.artist,f.title+"  /  "+f.album)}else setTimeout(function(){d.showFileName(a,b,!0)},200)},selectDown:function(){var a=d("tr.ui-selected");a.size()?a.UNSELECT(!0).next().andSelf().last().SELECT().LASTSELECT():(a=d("tr.last-select"),a.size()?
a.last().SELECT().LASTSELECT():d("tr.nP").next().andSelf().last().SELECT().LASTSELECT().size()||d("tr",this.div.tbody).first().SELECT().LASTSELECT())},extendDown:function(){var a=d("tr.last-select");a.size()&&(a.prev().ISSELECTED()?a.prevAll().filter(function(){var a=!0;return function(){return a&&(a=d(this).ISSELECTED())}}()).last().UNSELECT():a.nextAll().filter(function(){var a=!0;return function(){return a&&(a=d(this).prev().ISSELECTED())}}()).last().SELECT())},selectUp:function(){var a=d("tr.ui-selected");
a.size()?a.UNSELECT(!0).prev().andSelf().first().SELECT().LASTSELECT():(a=d("tr.last-select"),a.size()?a.first().SELECT().LASTSELECT():d("tr.nP").prev().andSelf().first().SELECT().LASTSELECT().size()||d("tr",this.div.tbody).last().SELECT().LASTSELECT())},extendUp:function(){var a=d("tr.last-select");a.size()&&(a.next().ISSELECTED()?a.nextAll().filter(function(){var a=!0;return function(){return a&&(a=d(this).ISSELECTED())}}()).last().UNSELECT():a.prevAll().filter(function(){var a=!0;return function(){return a&&
(a=d(this).next().ISSELECTED())}}()).last().SELECT())},selectHome:function(){d("tr.ui-selected").UNSELECT(!0);this.div.tbody.children().first().SELECT().LASTSELECT()},extendToHome:function(){d("tr.ui-selected").removeClass("ui-selected ddms_selected");d("tr.last-select").SELECT(!0).prevAll().SELECT(!0).last().SELECT()},selectEnd:function(){d("tr.ui-selected").UNSELECT(!0);this.div.tbody.children().last().SELECT().LASTSELECT()},extendToEnd:function(){d("tr.ui-selected").removeClass("ui-selected ddms_selected");
d("tr.last-select").SELECT(!0).nextAll().SELECT(!0).last().SELECT()},selectAll:function(){this.div.tbody.children().SELECT(!0).last().LASTSELECT()},unselectAll:function(){this.div.tbody.children().UNSELECT(!0)},selectInvert:function(){var a=d("tr.ui-selected");this.div.tbody.children().SELECT(!0).last().LASTSELECT();a.UNSELECT(!0)},toggleHelp:function(){this.div.help.fadeToggle(200);d("div#help:hidden").size()&&div.tablebody.focus()},toggleAbout:function(){this.div.about.fadeToggle(200)},deleteSelected:function(){var a=
this.player;d("tr.ui-selected").last().next().LASTSELECT();d("tr.ui-selected").first().prev().LASTSELECT(!0);d("tr.ui-selected").map(function(b,c){return a.remove(parseInt(d(c).attr("number"),10))});d("tr.ui-selected").remove()},selectNowplaying:function(){d("tr.ui-selected").UNSELECT();d("tr.nP").SELECT().LASTSELECT();this.focusIndex=0;this.focusUpdate()},pageDown:function(){this.div.tablebody.scrollTop(this.div.tablebody.scrollTop()+0.8*this.div.tablebody.height());d("tr.ui-selected").UNSELECT(!0);
var a=k.innerHeight;d("tr",this.div.tbody).filter(function(){return d(this).position().top<a}).last().SELECT().LASTSELECT()},extendPageDown:function(){var a=this;a.div.tablebody.scrollTop(a.div.tablebody.scrollTop()+0.8*a.div.tablebody.height());if(d("tr.last-select").prev().ISSELECTED())d("tr.ui-selected").filter(function(){return d(this).position().top<a.div.thead.position().top+40}).UNSELECT(!0);else{var b=k.innerHeight;d("tr.last-select").nextAll().filter(function(){return d(this).position().top<
b}).SELECT(!0).last().SELECT()}},pageUp:function(){this.div.tablebody.scrollTop(this.div.tablebody.scrollTop()-0.8*this.div.tablebody.height());d("tr.ui-selected").UNSELECT(!0);d("tr",this.div.tbody).filter(function(){return 0<d(this).position().top}).first().SELECT().LASTSELECT()},extendPageUp:function(){this.div.tablebody.scrollTop(this.div.tablebody.scrollTop()-0.8*this.div.tablebody.height());var a=k.innerHeight,b=d("tr.last-select",this.div.tbody);b.next().ISSELECTED()?d("tr.ui-selected").filter(function(){return d(this).position().top>
a-50}).UNSELECT(!0):b.prevAll().filter(function(){return 0<d(this).position().top}).SELECT(!0).last().SELECT()},defaultEnter:function(){if(!d("textarea#shortcuts:focus").size())switch(d("div#help:visible,div#config:visible,div#about:visible,div#property:visible").size()){case 0:var a=d("tr.last-select");a.size()?(d("tr.ui-selected").UNSELECT(!0),a.SELECT().children().first().dblclick()):d("tr.ui-selected").UNSELECT(!0).first().children().first().dblclick();break;default:this.div.config.add(this.div.help).add(this.div.property).add(this.div.about).filter(function(){return d(":visible",
this).size()}).last().fadeOut(200)}},viewInformation:function(){var a=this.player;this.div.property.fadeIn(200);if(a.tags){var b={TALB:"album",TIT2:"title",TPE1:"artist",TRCK:"track",TDRC:"year"},c=d("tr.ui-selected").map(function(b,c){return a.tags[parseInt(d(c).attr("number"),10)]}),e;for(e in b)d("dd#id"+b[e]).text("\u3000"+c.map(function(a,b){return b[e]}).unique().join())}},escape:function(){this.player.key.unlockAll();this.filterEnd();this.fullScreenOff();switch(d("#help:visible,#config:visible,#about:visible,#property:visible,#filter:visible").size()){case 0:d("div#musicSlider a:focus, div#volumeSlider a:focus").size()?
d("div#musicSlider a, div#volumeSlider a").focusout():d("tr.ui-selected").UNSELECT(!0);break;default:this.div.config.add(this.div.help).add(this.div.property).add(this.div.about).filter(function(){return d(":visible",this).size()}).last().fadeOut(200)}},click:function(a){var b=this.div[a]||d("img#"+a);b.mousedown().click();setTimeout(function(){b.mouseup()},200)},focusIndex:0,focusElements:function(){return[d("#tbody"),d("div#musicSlider a"),d("div#volumeSlider a")]},focusUpdate:function(a){this.focusElements()[this.focusIndex].focus();
a||0===this.focusIndex&&(d("tr.ui-selected").first().SELECT().size()||d("tr.nP").SELECT().LASTSELECT())},focusToggle:function(){this.focusIndex=(this.focusIndex+1)%3;this.focusUpdate()},focusToggleReverse:function(){this.focusIndex=(this.focusIndex-1+this.focusElements().length)%3;this.focusUpdate()},fullScreen:!1,setVideoSize:function(a,b){this.div.video.style.width=a+"px";this.div.video.style.marginLeft=-a/2+"px";this.div.video.style.height=b+"px";this.div.video.style.marginTop=-b/2+"px"},fullScreenOnVideo:function(){var a=
this.div.video;a.controls=!1;a.style.cursor="none";document.onmousemove=function(){a.controls=!0;a.style.cursor="true";setTimeout(function(){a.controls=!1;a.style.cursor="none"},1E3)};a.webkitRequestFullScreen?a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):this.setVideoSize(k.outerWidth,k.outerHeight)},fullScreenOnAudio:function(){this.div.info[0].webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);var a=k.screen.availHeight,a=["div#wrapper div#info{","  height: "+a+"px!important;","}",
"div#wrapper div#filename{","  margin-top:"+0.4*a+"px!important;","}","div#wrapper div#seek{","  top:"+0.5*a+"px!important;","}","div#wrapper div#albumart{","  width: "+0.4*a+"px!important;","  height: "+0.4*a+"px!important;","  margin-top:"+-0.2*a+"px!important;","}","div#wrapper div#albumart img{","  width: "+0.4*a+"px!important;","  height: "+0.4*a+"px!important;","}"];d("style#full").text(a.join("\n"));this.div.info.addClass("full")},fullScreenType:null,fullScreenOn:function(){if(this.player.playing){if("video"===
this.player.playing.filetype){if(this.fullScreen&&"video"===this.fullScreenType)return;this.fullScreenOffAudio();this.fullScreenOnVideo();var a=this;setTimeout(function(){a.fullScreenOnVideo()},500);this.fullScreenType="video"}else if("audio"===this.player.playing.filetype){if(this.fullScreen&&"audio"===this.fullScreenType)return;this.fullScreenOffVideo();this.fullScreenOnAudio();this.fullScreenType="audio"}this.fullScreen=!0}},fullScreenOffVideo:function(){var a;document.webkitCancelFullScreen?document.webkitCancelFullScreen():
this.setVideoSize(a=0.6*k.outerWidth,9*(a/16))},fullScreenOffAudio:function(){this.div.info.removeClass("full");d("style#full").text("")},fullScreenOff:function(){this.fullScreenType="";this.fullScreen=!1;this.fullScreenOffVideo();this.fullScreenOffAudio()},fullScreenToggle:function(){this.fullScreen?this.fullScreenOff():this.fullScreenOn()},initFilter:function(){var a=this;this.div.filterword.keydown(function(b){a.filterKeydown(b)})},filterStart:function(){var a=[];d("ui-selected");this.div.filter.fadeIn(200);
var b=this.div.filterword.focus()[0];b.selectionStart=0;b.selectionEnd=b.value.length;d("tr",this.div.tbody).each(function(b,e){var f=b,g=self.player.musics[d(e).attr("number")].tags,i=[];for(b in g)i.push(g[b]);a[f]=i.join("\u2022").toLowerCase()});this.div.matchnum.text("");this.filterTags=a},filterKeydown:function(a){var b=this;setTimeout(function(){if(13===a.keyCode)b.filterBlink();else if(27===a.keyCode)b.filterEnd();else{var c=a.target.value.toLowerCase(),e=[],f=d("tr",b.div.tbody);d("tr.ui-selected",
b.div.tbody).UNSELECT(!0);if(c)try{b.filterTags.forEach(function(a,b){null!==a.match(c)&&e.push(b)}),e.forEach(function(a){f.eq(a).SELECT(!0)}),b.div.matchnum.text(e.length+"/"+f.length),d("tr.ui-selected")}catch(g){}else b.div.matchnum.text("0/"+f.length)}},20)},filterEnd:function(){this.div.filter.fadeOut(200);this.div.filterword.focusout();this.focusUpdate()},filterIndex:0,filterBlink:function(){if(isNaN(this.filterIndex))this.filterIndex=0;var a=d("tr.ui-selected"),b=a.eq(this.filterIndex).UNSELECT(!0);
setTimeout(function(){b.SELECT(!1,!0).LASTSELECT()},200);this.filterIndex=++this.filterIndex%a.size()}};d.fn.SELECT=function(a,b){if(this.size()){this.addClass("ui-selected ddms_selected");if(a)return this;var c=this.offset().top,d=p.div.tablebody.offset().top,f=c-30-d,c=c+60-p.div.tablediv.height()-d;0>f?b?p.div.tablebody.animate({scrollTop:"+="+f},{duration:"fast",easing:"linear"}):p.div.tablebody.scrollTop(p.div.tablebody.scrollTop()+f):0<c&&(b?p.div.tablebody.animate({scrollTop:"+="+c},{duration:"fast",
easing:"linear"}):p.div.tablebody.scrollTop(p.div.tablebody.scrollTop()+c))}return this};d.fn.UNSELECT=function(a){a||this.SELECT();return this.removeClass("ui-selected ddms_selected last-select")};d.fn.LASTSELECT=function(a){a||d("tr.last-select",p.div.tbody).removeClass("last-select");return this.addClass("last-select")};d.fn.ISSELECTED=function(){return this.hasClass("ui-selected")};d.fn.drag_drop_multi_select.defaults.after_drop_action=function(a,b,c,e){h("drag_drop_multi_select.defaults.after_drop_action");
console.dir(e);console.dir(e.clientY);console.dir(d(e));var b=a.first().attr("number"),f=d("tr",p.div.tbody).first().height()/2,g=e.clientY,e=d("tr",p.div.tbody).filter(function(){var a=g-d(this).offset().top;return-f<=a&&a<f}).first();b===e.attr("number")&&(e=a.last().next());a.insertBefore(e).addClass("ui-selected moved");console.log(e);setTimeout(function(){p.selectableSet()},30);setTimeout(function(){d("tr.ui-selected",p.div.tbody).removeClass("ui-selected moved last-select");p.setorder()},1E3)};
H.prototype={keys:[],callback:{},init:function(a){this.app=a;var b=this;d(k).keypress(function(a){switch(a.target.localName){case "input":case "textarea":break;default:b.prevent(a)}});d(k).keydown(function(a){switch(a.target.localName){case "input":case "textarea":break;default:b.keydown(a),b.callback[b.convert(a)]&&b.prevent(a)}})},keydown:function(a){this.onlyMeta(a)||this.keydownstr(this.convert(a),a)},keydownstr:function(a,b){var c=this;c.keyqueue.push(a);if(c.triggerTimer)clearTimeout(c.triggerTimer),
c.triggerTimer=void 0;c.triggerInstantly()?c.trigger(b):c.triggerTimer=setTimeout(function(){c.trigger(b)},c.watingTime)},triggerInstantly:function(){var a=this.keyqueue.join(" "),b=this.keys.indexOf(a);return 0>b?!1:void 0!==this.keys[b+1]&&0>this.keys[b+1].indexOf(a)?!0:!1},onlyMeta:function(a){switch(this.codes[a.keyCode]){case "alt":case "ctrl":case "shift":return!0;default:return!1}},trigger:function(a){var b=this.keyqueue.join(" ");j(b);if(b=this.callback[b])this.prevent(a),b(this.app,a);this.keyqueue=
[]},keyqueue:[],triggerTimer:void 0,watingTime:480,prevent:function(a){a&&a.preventDefault&&a.preventDefault()},convert:function(a){var b=this.meta(a);return""!==b||this.codes[a.keyCode]&&1<this.codes[a.keyCode].length?"<"+b+this.keyCode(a.keyCode)+">":this.keyCode(a.keyCode)},meta:function(a){return(a.global?"g-":"")+(a.ctrlKey||a.metaKey||this.lockconfig.ctrlKey?"c-":"")+(a.shiftKey||this.lockconfig.shiftKey?"s-":"")+(a.altKey||this.lockconfig.altKey?"a-":"")},parse:function(a){for(var a=a.toLowerCase().replace(/ /g,
""),b=[],c=[];a;){if(!(c=a.match(/^<[^<>]*>/)))c=[a[0]];b=b.concat(c);a=a.slice(c[0].length)}return b.join(" ")},set:function(a,b){var c=this;"function"===typeof b?c.callback[a]=b:"string"===typeof b&&(c.callback[a]=function(){return function(){for(var a=c.parse(b).split(" "),d=0;d<a.length;d++)setTimeout(function(b){return function(){c.keydownstr(a[b])}}(d),10*d)}}(c.callback))},lock:function(a){void 0!==this.lockconfig[a]&&(j("lock"+a),this.lockconfig[a]=!0);return this},lockAll:function(){for(var a in this.lockconfig)this.lockconfig.hasOwnProperty(a)&&
(this.lockconfig[a]=!0)},unlock:function(a){void 0!==this.lockconfig[a]&&(this.lockconfig[a]=!1);return this},unlockAll:function(){for(var a in this.lockconfig)this.lockconfig.hasOwnProperty(a)&&(this.lockconfig[a]=!1)},togglelock:function(a){void 0!==this.lockconfig[a]&&(this.lockconfig[a]=!this.lockconfig[a]);return this},lockconfig:{shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1},codes:{8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",32:"space",33:"pgup",34:"pgdn",35:"end",
36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",91:"ctrl",106:"*",107:"+",111:"/",144:"numlock",186:":",187:";",188:",",189:"-",190:".",191:"/",192:"@",219:"[",220:"\\",221:"]",222:"^",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},keyCode:function(a){if(this.codes[a])return this.codes[a];if(48<=a&&57>=a)return a-48;if(65<=a&&90>=a)return String.fromCharCode(a).toLowerCase();if(96<=a&&105>=a)return a-96;j("unknown key: "+
a)}};var g={PlayPause:function(){return function(a){a.ui.click("play")}},OpenFile:function(){return function(a){a.ui.click("open")}},NextMusic:function(){return function(a){a.next()}},PreviousMusic:function(){return function(a){a.prev()}},SeekForward:function(a){return function(b){b.seekBy(parseInt(a[0],10))}},SeekBackward:function(a){return function(b){b.seekBy(-parseInt(a[0],10))}},SeekPercent:function(a){return function(b){b.seekAt(parseInt(a[0],10))}},ToggleRepeat:function(){return function(a){a.ui.click("repeat")}},
ToggleShuffle:function(){return function(a){a.ui.click("shuffle")}},VolumeUp:function(){return function(a){a.volumeup()}},VolumeDown:function(){return function(a){a.volumedown()}},VolumeMute:function(){return function(a){a.ui.click("mute")}},VolumeResume:function(){return function(a){a.ui.click("volumeon")}},VolumeToggleMute:function(){return function(a){a.ui.click(a.ismute()?"volumeon":"mute")}},SelectDown:function(){return function(a){a.ui.selectDown()}},ExtendDown:function(){return function(a){a.ui.extendDown()}},
SelectUp:function(){return function(a){a.ui.selectUp()}},ExtendUp:function(){return function(a){a.ui.extendUp()}},SelectHome:function(){return function(a){a.ui.selectHome()}},ExtendToHome:function(){return function(a){a.ui.extendToHome()}},SelectEnd:function(){return function(a){a.ui.selectEnd()}},ExtendToEnd:function(){return function(a){a.ui.extendToEnd()}},SelectAll:function(){return function(a){a.ui.selectAll()}},UnselectAll:function(){return function(a){a.ui.unselectAll()}},SelectInvert:function(){return function(a){a.ui.selectInvert()}},
PageDown:function(){return function(a){a.ui.pageDown()}},ExtendPageDown:function(){return function(a){a.ui.extendPageDown()}},PageUp:function(){return function(a){a.ui.pageUp()}},ExtendPageUp:function(){return function(a){a.ui.extendPageUp()}},DeleteSelected:function(){return function(a){a.ui.deleteSelected()}},SelectNowplaying:function(){return function(a){a.ui.selectNowplaying()}},ShiftLock:function(){return function(a){a.key.lock("shiftKey")}},CtrlLock:function(){return function(a){a.key.lock("ctrlKey")}},
AltLock:function(){return function(a){a.key.lock("altKey")}},ShiftUnlock:function(){return function(a){a.key.unlock("shiftKey")}},CtrlUnlock:function(){return function(a){a.key.unlock("ctrlKey")}},AltUnlock:function(){return function(a){a.key.unlock("altKey")}},ShiftToggleLock:function(){return function(a){a.key.togglelock("shiftKey")}},CtrlToggleLock:function(){return function(a){a.key.togglelock("ctrlKey")}},AltToggleLock:function(){return function(a){a.key.togglelock("altKey")}},ToggleHelp:function(){return function(a){a.ui.toggleHelp()}},
ToggleAbout:function(){return function(a){a.ui.toggleAbout()}},OpenConfig:function(){return function(a){a.ui.click("conf")}},DefaultEnter:function(){return function(a){a.ui.defaultEnter()}},ViewInformation:function(){return function(a){a.ui.viewInformation()}},Escape:function(){return function(a){a.ui.escape()}},FocusToggle:function(){return function(a){a.ui.focusToggle()}},FocusToggleReverse:function(){return function(a){a.ui.focusToggleReverse()}},FullScreenOn:function(){return function(a){a.ui.fullScreenOn()}},
FullScreenOff:function(){return function(a){a.ui.fullScreenOff()}},FullScreenToggle:function(){return function(a){a.ui.fullScreenToggle()}},FilterStart:function(){return function(a){a.ui.filterStart()}},Nop:function(){return function(){}},Define:function(){return function(){}}};B.prototype={version:"2.0",start:function(){for(var a in this)if(this[a]&&this[a].init)this[a].init(this),this[a].app=this,j("init: "+a)},files:[],musics:[],tags:[],playing:null,nowplaying:0,filetypes:{audio:{regexp:/audio\/(mp3|wav|ogg|m4a)/,
string:"audio"},video:{regexp:/video\/(mp4)/,string:"video"}},readFiles:function(a){h("Player.prototype.readFiles");var b=this;[].forEach.call(a,function(c,d){a[d].filetype=c.type.match(b.filetypes.audio.regexp)?b.filetypes.audio.string:c.type.match(b.filetypes.video.regexp)?b.filetypes.video.string:""});var c=[].filter.call(a,function(a){return""!==a.filetype}),d="false"===b.shuffle.value?b.musics.length:b.musics.length+Math.floor(Math.random()*Math.min(30,c.length)),f=b.musics.length;b.order.concat(c.map(function(a,
b){return f+b}));"true"===b.order.shuffle.value&&b.order.shuffleOn();[].forEach.call(c,function(a,c,g){setTimeout(function(a,c,d){return function(){b.readOneFile(a,c,d)}}(a,f+c===d,c===g.length-1),10*c)})},readOneFile:function(a,b,c){h("Player.prototype.readOneFile");var d=this.musics.length;this.files=this.files||[];this.files[d]=a;this.musics[d]=new G(a,"video"===a.filetype?this.ui.div.video:null);this.musics[d].tagread(function(a,b,c){return function(g){a.tags[b]=g;a.ui.ontagread(g,b);c&&a.play(d)}}(this,
d,!this.playing&&b));this.ui.addfile(a,d);c&&(this.ui.selectableSet(),this.ui.setdblclick())},play:function(a){h("Player.prototype.play");var b=this;void 0===a&&(a=0);b.order.atfromEnum(a);b.pause();b.playing&&b.playing.release();if(void 0!==a)b.nowplaying=a,b.playing=b.musics[a],b.playing.tags&&!b.playing.tags.picture&&b.playing.readpicture(),b.playing.play(b.volume.value/256,function(){b.next()}),b.ui.play(a),"video"===b.playing.filetype?b.ui.popupvideo():b.ui.hidevideo()},pause:function(){h("Player.prototype.pause");
this.ui.pause();this.playing&&this.playing.pause()},toggle:function(){h("Player.prototype.toggle");this.playing&&(this.playing.paused()?(this.playing.resume(),this.ui.play(this.nowplaying)):this.pause())},nextundefinedcount:0,next:function(){h("Player.prototype.next");this.pause();var a=this.order.next();if(void 0===a){this.playing&&this.playing.release();this.nextundefinedcount++;if(3>this.nextundefinedcount)return;this.nextundefinedcount=0;a=this.order.head();if(void 0===a)return}this.play(a)},
prevundefinedcount:0,prev:function(){h("Player.prototype.prev");this.pause();var a=this.order.prev();if(void 0===a){this.playing&&this.playing.release();this.prevundefinedcount++;if(3>this.prevundefinedcount)return;this.prevundefinedcount=0;a=this.order.last();if(void 0===a)return}this.play(a)},seekAt:function(a){h("Player.prototype.seekAt");return void 0!==this.playing&&this.playing.audio?(a=Math.max(0,Math.min(1,a)),this.playing.audio.currentTime=this.playing.audio.duration*a,!0):!1},seekBy:function(a){h("Player.prototype.seekBy");
void 0!==this.nowplaying&&this.playing&&this.playing.audio&&this.playing.seekBy(a)&&this.prev()},volume:new C(0,256,16,127),updatevolume:function(){h("Player.prototype.updatevolume");this.volume.at(this.ui.getvolume())},mute:function(){h("Player.prototype.mute");this.prevol=this.volume.value;this.volume.setToMin()},resume:function(){h("Player.prototype.resume");this.volume.at(this.prevol);delete this.prevol},togglemute:function(){h("Player.prototype.togglemute");this.ismute()?this.resume():this.mute()},
ismute:function(){h("Player.prototype.ismute");return 0===this.volume.value&&void 0!==this.prevol},volumeup:function(){h("Player.prototype.volumeup");this.volume.increase()},volumedown:function(){h("Player.prototype.volumedown");this.volume.decrease()},remove:function(a){h("Player.prototype.remove");this[a]=null;j("removing:::"+a);this.order.remove(a);j(this.order);j(this.order.array)},order:new n([],null,function(){})};B.prototype.repeat=new w(["false","true","one"],function(){return l.get("repeat")||
"false"},function(a,b){l.set("repeat",a);b.ui.setrepeat(a);"one"===a?b.order.repeatOne():"true"===a?b.order.repeatOn():b.order.repeatOff()});B.prototype.shuffle=new w(["false","true"],function(){return l.get("shuffle")||"false"},function(a,b){l.set("shuffle",a);b.ui.setshuffle(a);"true"===a?b.order.shuffleOn():b.order.shuffleOff()});B.prototype.volume=new C(0,256,16,function(){var a=parseInt(l.get("volume"),10);return void 0!==a?a:128},function(a,b){l.set("volume",a);b.ui.setvolume(a);b.playing&&
b.playing.setvolume(a/256)});B.prototype.message={init:function(){var a=this;chrome.extension.onRequest.addListener(function(b){switch(b.type){case "globalkeydown-bg":j(b);a.app.key.keydown(b);break;case "changescheme":a.app.ui.colorset()}})}};B.prototype.vim={visual:new w([!1,!0],!1,function(){})};var K=new B;k.onload=function(){K.start()};B.prototype.key=new H({"<space>":g.PlayPause([]),"<c-space>":"<space>","<g-c-space>":"<space>","<c-right>":g.NextMusic([]),"<g-c-right>":"<c-right>","<c-left>":g.PreviousMusic([]),
"<g-c-left>":"<c-left>","<c-o>":g.OpenFile([]),":o":"<c-o>",":e":"<c-o>","<right>":g.SeekForward(["10"]),"<s-right>":g.SeekForward(["30"]),l:"<right>",w:"<s-right>","<left>":g.SeekBackward(["10"]),"<s-left>":g.SeekBackward(["30"]),h:"<left>",b:"<s-left>","<s-4>":g.SeekPercent(["100"]),"<c-r>":g.ToggleRepeat([]),"<c-u>":g.ToggleShuffle([]),"<c-up>":g.VolumeUp([]),"<g-c-up>":"<c-up>","<c-down>":g.VolumeDown([]),"<g-c-down>":"<c-down>","<c-a-down>":g.VolumeToggleMute([]),"<g-c-a-down>":"<c-a-down>",
9:g.VolumeDown([]),"<down>":g.SelectDown([]),j:"<down>","<s-down>":g.ExtendDown([]),"<s-j>":"<s-down>","<up>":g.SelectUp([]),k:"<up>","<s-up>":g.ExtendUp([]),"<s-k>":"<s-up>","<home>":g.SelectHome([]),gg:"<home>","0":"<home>","<s-home>":g.ExtendToHome([]),"<end>":g.SelectEnd([]),"<s-g>":"<end>","<s-end>":g.ExtendToEnd([]),"<c-a>":g.SelectAll([]),"<c-s-a>":g.UnselectAll([]),"<c-i>":g.SelectInvert([]),"<pgdn>":g.PageDown([]),"<s-pgdn>":g.ExtendPageDown([]),"<pgup>":g.PageUp([]),"<c-b>":"<pgup>","<s-pgup>":g.ExtendPageUp([]),
"<s-/>":g.ToggleHelp([]),"<f1>":g.ToggleAbout([]),"[":"<f1>","<c-,>":g.OpenConfig([]),"<delete>":g.DeleteSelected([]),"<backspace>":"<delete>",d:"<delete>","<esc>":g.Escape([]),"<s-esc>":"<esc>","<c-[>":"<esc>","<c-s-[>":"<esc>","<enter>":g.DefaultEnter([]),"<a-enter>":g.ViewInformation([]),"<tab>":g.FocusToggle([]),"<s-tab>":g.FocusToggleReverse([]),f:g.FullScreenToggle([]),"<c-s-f>":g.FullScreenToggle([]),"<c-f>":g.FilterStart([]),"/":"<c-f>","<c-p>":"<nop>","<nop>":g.Nop([])});h=function(){};j=
function(){}})(this,"undefined"!==typeof jQuery?jQuery:{});
